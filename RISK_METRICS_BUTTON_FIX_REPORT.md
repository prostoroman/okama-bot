# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –∫–Ω–æ–ø–∫–∏ "–†–∏—Å–∫ –º–µ—Ç—Ä–∏–∫–∏" - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2025-01-27

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "üìä –†–∏—Å–∫ –º–µ—Ç—Ä–∏–∫–∏" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
‚ùå –î–∞–Ω–Ω—ã–µ –æ –ø–æ—Ä—Ç—Ñ–µ–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /portfolio –∑–∞–Ω–æ–≤–æ.
```

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ button_callback
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `risk_metrics_` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `button_callback`
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ callback_data –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- ‚úÖ –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `_handle_risk_metrics_button` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–∞ _handle_risk_metrics_button
- ‚úÖ –ú–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—ã–∑–æ–≤—É
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### 3. –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Ä—Ç—Ñ–µ–ª–µ (`current_symbols` –Ω–µ –Ω–∞–π–¥–µ–Ω)

**–ê–Ω–∞–ª–∏–∑**:
- –í –∫–æ–º–∞–Ω–¥–µ `/portfolio` –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ù–æ –≤ `_handle_risk_metrics_button` –º—ã –∏—â–µ–º —Ç–æ–ª—å–∫–æ `current_symbols`
- –í –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–∞—Ö (drawdowns, dividends, correlation) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ –∫–ª—é—á
- –í–æ–∑–º–æ–∂–Ω–æ, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ–¥ –¥—Ä—É–≥–∏–º –∫–ª—é—á–æ–º –∏–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤–æ–æ–±—â–µ

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ button_callback
**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 1830-1832

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
```python
elif callback_data.startswith('risk_metrics_'):
    symbols = callback_data.replace('risk_metrics_', '').split(',')
    self.logger.info(f"Risk metrics button clicked for symbols: {symbols}")
    self.logger.info(f"Callback data: {callback_data}")
    self.logger.info(f"Extracted symbols: {symbols}")
    await self._handle_risk_metrics_button(update, context, symbols)
```

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ _handle_risk_metrics_button
**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 2265-2285

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
```python
user_context = self._get_user_context(user_id)
self.logger.info(f"User context keys: {list(user_context.keys())}")
self.logger.info(f"User context content: {user_context}")

# ... –∏ –¥–∞–ª–µ–µ ...

self.logger.info(f"Creating risk metrics for portfolio: {symbols}, currency: {currency}, weights: {weights}")

# ... –∏ –≤ –±–ª–æ–∫–µ except ...

import traceback
self.logger.error(f"Traceback: {traceback.format_exc()}")
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 2275-2285

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
```python
# Try to get symbols from different possible keys
symbols = None
self.logger.info(f"Available keys in user context: {list(user_context.keys())}")

if 'current_symbols' in user_context:
    symbols = user_context['current_symbols']
    self.logger.info(f"Found symbols in current_symbols: {symbols}")
elif 'last_assets' in user_context:
    symbols = user_context['last_assets']
    self.logger.info(f"Found symbols in last_assets: {symbols}")
else:
    self.logger.warning(f"Neither current_symbols nor last_assets found in user context")
    self.logger.warning(f"Available keys: {list(user_context.keys())}")
    await self._send_callback_message(update, context, "‚ùå –î–∞–Ω–Ω—ã–µ –æ –ø–æ—Ä—Ç—Ñ–µ–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /portfolio –∑–∞–Ω–æ–≤–æ.")
    return
```

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ portfolio
**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 1580-1595

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
```python
# Store portfolio data in context
user_id = update.effective_user.id
self.logger.info(f"Storing portfolio data in context for user {user_id}")
self.logger.info(f"Symbols: {symbols}")
self.logger.info(f"Currency: {currency}")
self.logger.info(f"Weights: {weights}")

self._update_user_context(
    user_id, 
    last_assets=symbols,
    last_analysis_type='portfolio',
    last_period='MAX',
    current_symbols=symbols,
    current_currency=currency,
    current_currency_info=currency_info,
    portfolio_weights=weights
)

# Verify context was saved
saved_context = self._get_user_context(user_id)
self.logger.info(f"Saved context keys: {list(saved_context.keys())}")
self.logger.info(f"Saved current_symbols: {saved_context.get('current_symbols')}")
self.logger.info(f"Saved last_assets: {saved_context.get('last_assets')}")
self.logger.info(f"Saved portfolio_weights: {saved_context.get('portfolio_weights')}")
```

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ callback_data
- –ü–æ–ª–Ω—ã–π callback_data –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞
- –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—Å–µ –∫–ª—é—á–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –°–∏–º–≤–æ–ª—ã, –≤–∞–ª—é—Ç–∞ –∏ –≤–µ—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –ü–æ–ª–Ω—ã–π traceback –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ç–ª–∞–¥–∫–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã `/portfolio` –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
Storing portfolio data in context for user {user_id}
Symbols: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Currency: RUB
Weights: [0.4, 0.3, 0.3]
Saved context keys: ['last_assets', 'last_analysis_type', 'last_period', 'current_symbols', 'current_currency', 'current_currency_info', 'portfolio_weights']
Saved current_symbols: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Saved last_assets: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Saved portfolio_weights: [0.4, 0.3, 0.3]
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏
–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–†–∏—Å–∫ –º–µ—Ç—Ä–∏–∫–∏" –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
Button callback received: risk_metrics_SBER.MOEX,GAZP.MOEX,LKOH.MOEX
Processing callback data: risk_metrics_SBER.MOEX,GAZP.MOEX,LKOH.MOEX
Risk metrics button clicked for symbols: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Callback data: risk_metrics_SBER.MOEX,GAZP.MOEX,LKOH.MOEX
Extracted symbols: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Handling risk metrics button for user {user_id}
User context keys: ['last_assets', 'last_analysis_type', 'last_period', 'current_symbols', 'current_currency', 'current_currency_info', 'portfolio_weights']
User context content: {...}
Available keys in user context: ['last_assets', 'last_analysis_type', 'last_period', 'current_symbols', 'current_currency', 'current_currency_info', 'portfolio_weights']
Found symbols in current_symbols: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX']
Creating risk metrics for portfolio: ['SBER.MOEX', 'GAZP.MOEX', 'LKOH.MOEX'], currency: RUB, weights: [0.4, 0.3, 0.3]
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç:
- `current_symbols` - —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `last_assets` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–ª—é—á –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤
- `current_currency` - –±–∞–∑–æ–≤–∞—è –≤–∞–ª—é—Ç–∞
- `portfolio_weights` - –≤–µ—Å–∞ –∞–∫—Ç–∏–≤–æ–≤

## –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `/portfolio` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ—á–∏—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Okama
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–æ–≤
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –º–µ—Ç–æ–¥–µ describe():
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Okama
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ Portfolio
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤ risk_annual, semideviation_annual –∏ –¥—Ä.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è
```bash
python3 -m py_compile bot.py
```
‚úÖ –§–∞–π–ª –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### 2. –õ–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
–°–æ–∑–¥–∞–Ω –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª:
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ callback_data
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –≤–µ—Å–æ–≤ –ø–æ—Ä—Ç—Ñ–µ–ª—è

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω –≤ button_callback
- ‚úÖ –ú–µ—Ç–æ–¥ _handle_risk_metrics_button —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–ª—é—á–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞** —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º
2. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É** `/portfolio SBER.MOEX:0.4 GAZP.MOEX:0.3 LKOH.MOEX:0.3`
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
4. **–ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É** "üìä –†–∏—Å–∫ –º–µ—Ç—Ä–∏–∫–∏"
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–∏—Å–∫–µ —Å–∏–º–≤–æ–ª–æ–≤
6. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É** –æ—à–∏–±–∫–∏ –ø–æ –ª–æ–≥–∞–º

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–Ω–æ–ø–∫–æ–π "–†–∏—Å–∫ –º–µ—Ç—Ä–∏–∫–∏". 

**–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**:
- –ü–æ–∏—Å–∫ —Å–∏–º–≤–æ–ª–æ–≤ –≤ `current_symbols` –∏ `last_assets`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ portfolio
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–ª—é—á–µ–π

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ:
- –î–∞–Ω–Ω—ã—Ö, –ø—Ä–∏—à–µ–¥—à–∏—Ö –≤ callback
- –°–æ—Å—Ç–æ—è–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–æ—Ü–µ—Å—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ—Ü–µ—Å—Å–µ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤
- –î–µ—Ç–∞–ª—å–Ω–æ–º traceback –æ—à–∏–±–∫–∏

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –µ—ë –≤ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏. üöÄ
