# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ chart_styles –≤ –º–µ—Ç–æ–¥–∞—Ö Monte Carlo –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2025-01-27

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "üé≤ Monte Carlo" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ Monte Carlo: ChartStyles.apply_base_style() missing 1 required positional argument: 'ax'
```

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞
–í –º–µ—Ç–æ–¥–∞—Ö `_create_monte_carlo_forecast` –∏ `_create_forecast_chart` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤:
```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
fig = chart_styles.create_figure()
chart_styles.apply_base_style(fig)  # –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç 'ax'
```

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
–í –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–∞—Ö –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤:
```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
fig, ax = chart_styles.create_figure()
chart_styles.apply_base_style(fig, ax)
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤ okama
–ú–µ—Ç–æ–¥—ã `portfolio.plot_forecast_monte_carlo()` –∏ `portfolio.plot_forecast()` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ okama:
- –°–æ–∑–¥–∞—é—Ç —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ matplotlib
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ —Ñ–∏–≥—É—Ä—É
- –ì—Ä–∞—Ñ–∏–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–µ–∫—É—â–∏–º –∞–∫—Ç–∏–≤–Ω—ã–º (`plt.gcf()`)

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ _create_monte_carlo_forecast

**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 2636-2670

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# ‚ùå –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
fig = chart_styles.create_figure()
chart_styles.apply_base_style(fig)

# ‚úÖ –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
forecast_data = portfolio.plot_forecast_monte_carlo(distr="norm", years=5, n=20)
current_fig = plt.gcf()

if current_fig.axes:
    ax = current_fig.axes[0]  # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—ã–π axes
    chart_styles.apply_base_style(current_fig, ax)
    
    # –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
    ax.set_title(f'–ü—Ä–æ–≥–Ω–æ–∑ Monte Carlo\n{", ".join(symbols)}', ...)
    chart_styles.add_copyright(ax)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ _create_forecast_chart

**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 2680-2720

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# ‚ùå –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
fig = chart_styles.create_figure()
chart_styles.apply_base_style(fig)

# ‚úÖ –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
forecast_data = portfolio.plot_forecast(years=5, today_value=1000, percentiles=[10, 50, 90])
current_fig = plt.gcf()

if current_fig.axes:
    ax = current_fig.axes[0]  # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—ã–π axes
    chart_styles.apply_base_style(current_fig, ax)
    
    # –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
    ax.set_title(f'–ü—Ä–æ–≥–Ω–æ–∑ —Å –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—è–º–∏\n{", ".join(symbols)}', ...)
    chart_styles.add_copyright(ax)
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–≥—É—Ä–∞–º–∏ okama
1. **–í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ okama**: `portfolio.plot_forecast_monte_carlo()` –∏–ª–∏ `portfolio.plot_forecast()`
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Ñ–∏–≥—É—Ä—ã**: `current_fig = plt.gcf()`
3. **–î–æ—Å—Ç—É–ø –∫ axes**: `ax = current_fig.axes[0]`
4. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π**: `chart_styles.apply_base_style(current_fig, ax)`
5. **–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è**: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ø–∏—Ä–∞–π—Ç–∞
6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: `current_fig.savefig()`
7. **–û—á–∏—Å—Ç–∫–∞**: `plt.close(current_fig)`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è axes
```python
if current_fig.axes:
    ax = current_fig.axes[0]
    # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ axes —Å—É—â–µ—Å—Ç–≤—É—é—Ç
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è axes –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ç–∏–ª–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –±–ª–æ–∫–µ try-except
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ chart_styles
- –í—ã–∑–æ–≤ `apply_base_style(fig, ax)` —Å –¥–≤—É–º—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ API –º–æ–¥—É–ª—è chart_styles
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –±–æ—Ç–∞

### 2. –†–∞–±–æ—Ç–∞ —Å —Ñ–∏–≥—É—Ä–∞–º–∏ okama
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π okama
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ø–∏—Ä–∞–π—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–±—â–∏–º —Å—Ç–∏–ª–µ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ chart_styles

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è
```bash
python3 -m py_compile bot.py
```
‚úÖ –§–∞–π–ª –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### 2. –°–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã `chart_styles.apply_base_style(fig, ax)`
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∏–≥—É—Ä–∞–º–∏ matplotlib
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è axes

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∏–ª—è chart_styles
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º

### 1. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤ –ª–∏–Ω–∏–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è —Å–µ—Ç–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã

### 2. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è
- –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–º—É–ª—è—Ü–∏–π
- –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

### 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `chart_styles.apply_base_style()` –≤ –º–µ—Ç–æ–¥–∞—Ö Monte Carlo –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞. 

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- –£–±—Ä–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ `chart_styles.apply_base_style(fig)`
- –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ `chart_styles.apply_base_style(fig, ax)`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∏–≥—É—Ä–∞–º–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π okama
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–∑–∞–≥–æ–ª–æ–≤–∫–∏, –∫–æ–ø–∏—Ä–∞–π—Ç)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ —Å—Ç–∏–ª–∏–∑—É—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–±—â–∏–º –¥–∏–∑–∞–π–Ω–æ–º
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è okama

–¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ "üé≤ Monte Carlo" –∏ "üìà –ü—Ä–æ–≥–Ω–æ–∑ %" —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ –∏ —Å–æ–∑–¥–∞—é—Ç –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏! üöÄ
