# –û—Ç—á–µ—Ç –æ –¥–æ—Ä–∞–±–æ—Ç–∫–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–æ—Ä–∞–±–æ—Ç–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –º–µ—Ç–æ–¥–æ–≤ `get_compare_examples` –∏ `get_portfolio_examples` –≤ `ExamplesService` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –£–±—Ä–∞–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç—Ç–∏—Ö –∞–∫—Ç–∏–≤–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–º–∞–Ω–¥ `/portfolio` –∏ `/compare`.

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –î–æ—Ä–∞–±–æ—Ç–∫–∞ ExamplesService

#### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `_get_exchange_from_ticker(ticker: str) -> Optional[str]` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏—Ä–∂–∏ –ø–æ —Ç–∏–∫–µ—Ä—É
- `_get_tickers_from_exchange(exchange: str, exclude_tickers: List[str] = None) -> List[Tuple[str, str]]` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–∫–µ—Ä–æ–≤ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –±–∏—Ä–∂–∏
- `_get_exchange_from_context_tickers(context_tickers: List[str]) -> Optional[str]` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏—Ä–∂–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç–∏–∫–µ—Ä–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `get_compare_examples(count: int = 3, context_tickers: List[str] = None) -> List[str]`
- `get_portfolio_examples(count: int = 3, context_tickers: List[str] = None) -> List[str]`

### 2. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

#### –î–ª—è –∫–æ–º–∞–Ω–¥—ã `/compare`:
1. –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å `analyzed_tickers`, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –±–∏—Ä–∂–∞ –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
2. –ù–∞—Ö–æ–¥—è—Ç—Å—è –¥—Ä—É–≥–∏–µ –∞–∫—Ç–∏–≤—ã —Å —Ç–æ–π –∂–µ –±–∏—Ä–∂–∏ (–∏—Å–∫–ª—é—á–∞—è —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ)
3. –§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ —Ç–∏–∫–µ—Ä–∞ –∏ –Ω–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ —Å —Ç–æ–π –∂–µ –±–∏—Ä–∂–∏
4. –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

#### –î–ª—è –∫–æ–º–∞–Ω–¥—ã `/portfolio`:
1. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–æ–º–∞–Ω–¥–µ `/compare`, –Ω–æ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 3 –∞–∫—Ç–∏–≤–∞
2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π —Ç–∏–∫–µ—Ä + 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å —Ç–æ–π –∂–µ –±–∏—Ä–∂–∏
3. –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Å–∞, —Å—É–º–º–∏—Ä—É—é—â–∏–µ—Å—è –≤ 1.0

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –≤ bot.py

#### –ö–æ–º–∞–Ω–¥–∞ `/portfolio`:
- –£–±—Ä–∞–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ "üïí *–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ –∞–∫—Ç–∏–≤—ã:*"
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `analyzed_tickers` –≤ `get_portfolio_examples()`

#### –ö–æ–º–∞–Ω–¥–∞ `/compare`:
- –£–±—Ä–∞–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ "üïí *–ò—Å—Ç–æ—Ä–∏—è:*"
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `analyzed_tickers` –≤ `get_compare_examples()`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_examples_context_integration.py` –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

### ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏—Ä–∂–∏ –ø–æ —Ç–∏–∫–µ—Ä—É
```
SBER.MOEX -> MOEX
AAPL.US -> US
SHEL.LSE -> LSE
00700.HKEX -> HKEX
600519.SSE -> SSE
300750.SZSE -> SZSE
SAP.XETR -> XETR
ASML.XAMS -> XAMS
LUMI.XTAE -> XTAE
```

### ‚úÖ –ü—Ä–∏–º–µ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å MOEX –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
```
–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã: ['SBER.MOEX', 'GAZP.MOEX']
–ü—Ä–∏–º–µ—Ä—ã:
1. `SBER.MOEX NLMK.MOEX` - —Å—Ä–∞–≤–Ω–∏—Ç—å Sberbank –∏ NLMK
2. `IRAO.MOEX GMKN.MOEX` - —Å—Ä–∞–≤–Ω–∏—Ç—å Inter RAO –∏ Norilsk Nickel
3. `IRAO.MOEX MTSS.MOEX` - —Å—Ä–∞–≤–Ω–∏—Ç—å Inter RAO –∏ MTS
```

### ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è —Å US –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
```
–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã: ['AAPL.US', 'MSFT.US']
–ü—Ä–∏–º–µ—Ä—ã:
1. `AAPL.US:0.0 GOOG.US:0.6 NVDA.US:0.4` - —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å Apple, Alphabet (Class C), NVIDIA
2. `NVO.US:0.1 V.US:0.6 MA.US:0.3` - —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å Novo Nordisk (ADR), Visa (Class A), Mastercard (Class A)
3. `WMT.US:0.7 XOM.US:0.1 MA.US:0.2` - —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å Walmart, Exxon Mobil, Mastercard (Class A)
```

### ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
–ë–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ, –≥–µ–Ω–µ—Ä–∏—Ä—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã.

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏

1. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: –ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ—Å—Ç—å**: –ê–∫—Ç–∏–≤—ã –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —Ç–æ–π –∂–µ –±–∏—Ä–∂–µ, —á—Ç–æ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ
3. **–£–¥–æ–±—Å—Ç–≤–æ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –≤–∏–¥–µ—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–∫—Ç–∏–≤–æ–≤ - –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø—Ä–∏–º–µ—Ä—ã
4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- `services/examples_service.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- `bot.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ `/portfolio` –∏ `/compare`
- `tests/test_examples_context_integration.py` - —Ç–µ—Å—Ç—ã

## –°—Ç–∞—Ç—É—Å

‚úÖ **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞**

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- ‚úÖ –ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ –∞–∫—Ç–∏–≤—ã, –ø—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Å –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –±–∏—Ä–∂–∞ –∞–∫—Ç–∏–≤–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –ù–∞—Ö–æ–¥—è—Ç—Å—è –µ—â–µ –∞–∫—Ç–∏–≤—ã –∏–∑ —ç—Ç–æ–π –±–∏—Ä–∂–∏
- ‚úÖ –ü—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
- ‚úÖ –£–±—Ä–∞–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–º–∞–Ω–¥
