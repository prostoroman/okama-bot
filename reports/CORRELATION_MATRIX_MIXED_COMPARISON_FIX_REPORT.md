# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–ø–æ—Ä—Ç—Ñ–µ–ª–∏ + –∞–∫—Ç–∏–≤—ã) –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã (—Ç–æ–ª—å–∫–æ LKOH.MOEX). –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∞–∫—Ç–∏–≤–∞.
```

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –ø—ã—Ç–∞–ª–∞—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –º–µ–∂–¥—É –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏ –∫–∞–∫ –µ–¥–∏–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.

## –†–µ—à–µ–Ω–∏–µ
–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:

### 1. –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–±–æ—Ä–∞ –∞–∫—Ç–∏–≤–æ–≤
- **–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥**: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏ (–∫–∞–∫ –µ–¥–∏–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏) –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏
- **–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥**: –°–±–æ—Ä –≤—Å–µ—Ö –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ –∏–∑ –≤—Å–µ—Ö –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π + –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—ã—Ö –∞–∫—Ç–∏–≤–æ–≤

### 2. –£–ø—Ä–æ—â–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π `AssetList` –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —á–µ—Ä–µ–∑ `assets_ror.corr()`

### 3. –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `_format_correlation_values()` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–¥ –º–∞—Ç—Ä–∏—Ü–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∫–∞–∫ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ, —Ç–∞–∫ –∏ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ú–µ—Ç–æ–¥ `_create_mixed_comparison_correlation_matrix()`
```python
# –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ - —Å–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ
# –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ - —Å–±–æ—Ä –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤ –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫
all_assets = set()

# –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤—ã –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
for portfolio_context in portfolio_contexts:
    portfolio_assets = portfolio_context.get('portfolio_symbols', [])
    all_assets.update(portfolio_assets)

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç—ã–µ –∞–∫—Ç–∏–≤—ã
for expanded_symbol in expanded_symbols:
    if not isinstance(expanded_symbol, (pd.Series, pd.DataFrame)):
        all_assets.add(expanded_symbol)

# –°–æ–∑–¥–∞–µ–º –µ–¥–∏–Ω—ã–π AssetList
asset_list = ok.AssetList(all_assets, ccy=currency)
correlation_matrix = asset_list.assets_ror.corr()
```

### 2. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `_format_correlation_values()`
```python
def _format_correlation_values(self, correlation_matrix: pd.DataFrame) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥ –º–∞—Ç—Ä–∏—Ü–µ–π"""
    values_text = "üìä **–ß–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:**\n"
    
    symbols = correlation_matrix.columns.tolist()
    for i, symbol1 in enumerate(symbols):
        for j, symbol2 in enumerate(symbols):
            if i < j:  # Only upper triangle
                corr_value = correlation_matrix.iloc[i, j]
                values_text += f"‚Ä¢ {symbol1} ‚Üî {symbol2}: {corr_value:.3f}\n"
    
    return values_text
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_create_correlation_matrix()`
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `_format_correlation_values()` –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω —Ç–µ–∫—Å—Ç –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
- –û–±—ã—á–Ω–æ–µ –∏ —Å–º–µ—à–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–æ–≥–∏–∫—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –£–ø—Ä–æ—â–µ–Ω –∫–æ–¥ –∏ —É–º–µ–Ω—å—à–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
- –í–∫–ª—é—á–∞–µ—Ç –∞–∫—Ç–∏–≤—ã –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π + –ø—Ä–æ—Å—Ç—ã–µ –∞–∫—Ç–∏–≤—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
- –î–æ–±–∞–≤–ª–µ–Ω—ã —á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ–¥ –º–∞—Ç—Ä–∏—Ü–µ–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –§–æ—Ä–º–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á–µ –≤ –Ω–µ–π—Ä–æ–∞–Ω–∞–ª–∏–∑

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞
- –£–±—Ä–∞–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –ª–æ–≥–∏–∫–∞
- –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Python
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏ —Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∞–∫—Ç–∏–≤–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Å–º–µ—à–∞–Ω–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:
1. –°—Ç—Ä–æ–∏—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤ –∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π + –ø—Ä–æ—Å—Ç—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏
3. –í–∫–ª—é—á–∞–µ—Ç —á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ–¥ –º–∞—Ç—Ä–∏—Ü–µ–π
4. –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ "–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö"

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2024-12-19

## –°—Ç–∞—Ç—É—Å
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
