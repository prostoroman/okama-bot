# –û—Ç—á–µ—Ç –æ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏—è—Ö –º–µ—Ç—Ä–∏–∫ –∫–æ–º–∞–Ω–¥—ã /compare

## üéØ –¶–µ–ª—å
–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –º–µ—Ç—Ä–∏–∫ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare` —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å "–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)" –≤ "–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)" –≤ –ø–µ—Ä–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ
2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞" –ø–æ—Å–ª–µ "–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏" –≤ –ø–µ—Ä–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ
3. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥ (–∏–∑ —Å—Ç–æ–ª–±—Ü–∞ period describe) –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü–µ

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ CAGR –≤ –ø–µ—Ä–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∞ 8383

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å "–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)" –Ω–∞ "–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)"
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–∞

**–ö–æ–¥**:
```python
# CAGR row (full period)
cagr_row = ["–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)"]
for symbol in symbols:
    cagr = metrics_data.get(symbol, {}).get('cagr')
    if cagr is not None:
        cagr_row.append(f"{cagr*100:.2f}%")
    else:
        cagr_row.append("N/A")
table_data.append(cagr_row)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–æ–ª–µ–µ –∫—Ä–∞—Ç–∫–æ–µ –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ CAGR –º–µ—Ç—Ä–∏–∫–∏

### 2. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ "–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞" –ø–æ—Å–ª–µ "–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏"

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 8402-8410

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ "–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞" —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ "–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏"
- –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ "–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞" –∏–∑ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–µ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–æ–¥**:
```python
# Volatility row
volatility_row = ["–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å"]
# ... volatility calculation ...

# Max Drawdown row (moved after Volatility)
drawdown_row = ["–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞"]
for symbol in symbols:
    max_drawdown = metrics_data.get(symbol, {}).get('max_drawdown')
    if max_drawdown is not None:
        drawdown_row.append(f"{max_drawdown*100:.2f}%")
    else:
        drawdown_row.append("N/A")
table_data.append(drawdown_row)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–æ–ª–µ–µ –ª–æ–≥–∏—á–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ - –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ —Ä—è–¥–æ–º

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü–µ

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 8507-8516

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_describe_table`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ 'period'
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ —Å –ø–µ—Ä–∏–æ–¥–æ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–ù–∞–∑–≤–∞–Ω–∏–µ (–ü–µ—Ä–∏–æ–¥)"
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏

**–ö–æ–¥**:
```python
for idx in describe_data.index:
    property_name = describe_data.loc[idx, 'property']
    period = describe_data.loc[idx, 'period']
    
    # Create metric name with period information
    if pd.isna(period) or period == 'None' or period == '':
        metric_name = str(property_name)
    else:
        metric_name = f"{property_name} ({period})"
    
    row = [metric_name]
    # ... rest of the processing
```

**–ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–∏–æ–¥–æ–≤**:
- "Compound return (YTD)"
- "CAGR (1 years)"
- "CAGR (5 years)"
- "CAGR (10 years)"
- "CAGR (26 years, 5 months)"
- "Annualized mean return (26 years, 5 months)"
- "Dividend yield (LTM)"
- "Risk (26 years, 5 months)"

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ—á–Ω—ã–π –ø–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∞–π–ª —Ç–µ—Å—Ç–∞**: `tests/test_compare_metrics_final_enhancement.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
- ‚úÖ CAGR –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ '–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)'
- ‚úÖ '–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞' —Ä–∞–∑–º–µ—â–µ–Ω–∞ –ø–æ—Å–ª–µ '–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏'
- ‚úÖ –ü–µ—Ä–∏–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –º–µ—Ç—Ä–∏–∫
- ‚úÖ –ù–∞–π–¥–µ–Ω—ã –ø–µ—Ä–∏–æ–¥—ã –≤ —Ç–∞–±–ª–∏—Ü–µ: ['YTD', '1 years', '5 years', '10 years']

## üìä –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

### –ü–µ—Ä–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
```
| –ú–µ—Ç—Ä–∏–∫–∞                        | SPY.US   | QQQ.US   |
|:-------------------------------|:---------|:---------|
| –ü–µ—Ä–∏–æ–¥ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π              | 32.7 –ª–µ—Ç | 26.5 –ª–µ—Ç |
| –°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 1 –≥–æ–¥ | 15.61%   | 21.25%   |
| –°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 5 –ª–µ—Ç | 15.02%   | 16.84%   |
| –°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)       | 8.64%    | 6.71%    |
| –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å                  | 14.84%   | 25.24%   |
| –ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞                 | -52.20%  | -90.32%  |
| –ë–µ–∑—Ä–∏—Å–∫–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞             | 4.69%    | 4.69%    |
| –ö–æ—ç—Ñ—Ñ. –®–∞—Ä–ø–∞                   | 0.27     | 0.08     |
```

### –í—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—Å –ø–µ—Ä–∏–æ–¥–∞–º–∏):
```
| –ú–µ—Ç—Ä–∏–∫–∞                                     | SPY.US   | QQQ.US   |
|:--------------------------------------------|:---------|:---------|
| Compound return (YTD)                       | 10.71%   | 11.86%   |
| CAGR (1 years)                              | 15.85%   | 20.43%   |
| CAGR (5 years)                              | 14.68%   | 14.81%   |
| CAGR (10 years)                             | 14.50%   | 19.43%   |
| CAGR (26 years, 5 months)                   | 8.19%    | 10.14%   |
| Annualized mean return (26 years, 5 months) | 9.44%    | 13.20%   |
| Dividend yield (LTM)                         | 1.11%    | 0.49%    |
| Risk (26 years, 5 months)                   | 16.56%   | 26.47%   |
```

## üìã –ò—Ç–æ–≥–∏

1. **–£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω** CAGR –≤ –±–æ–ª–µ–µ –∫—Ä–∞—Ç–∫—É—é —Ñ–æ—Ä–º—É
2. **–£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞** "–ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞" –ø–æ—Å–ª–µ "–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏" –¥–ª—è –ª—É—á—à–µ–π –ª–æ–≥–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
3. **–£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã** –ø–µ—Ä–∏–æ–¥—ã –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –±–æ–ª—å—à–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
4. **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã** –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

–ö–æ–º–∞–Ω–¥–∞ `/compare` —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –º–µ—Ç—Ä–∏–∫ —Å —á–µ—Ç–∫–∏–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–µ—Ä–∏–æ–¥–æ–≤ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏.
