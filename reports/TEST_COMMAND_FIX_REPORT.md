# üîß –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã /test

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã

–ö–æ–º–∞–Ω–¥–∞ `/test` –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –Ω–æ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–∏–≤–∞–ª–∏—Å—å –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ `risk_metrics`, `monte_carlo` –∏ `forecast`.

## ‚ùå –ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–º–∞–Ω–¥—ã `/test` –≤ Telegram –±–æ—Ç–µ –≤—ã–≤–æ–¥–∏–ª–æ—Å—å:

```
‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–¢–∏–ø —Ç–µ—Å—Ç–æ–≤: quick
–°—Ç–∞—Ç—É—Å: –ü—Ä–æ–≤–∞–ª–µ–Ω—ã
–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 5.5 —Å–µ–∫

–í—ã–≤–æ–¥ —Ç–µ—Å—Ç–æ–≤:
...
2025-09-09 13:17:45,987 - WARNING - Unknown button callback: risk_metrics
2025-09-09 13:17:45,987 - WARNING - Unknown button callback: monte_carlo
2025-09-09 13:17:45,988 - WARNING - Unknown button callback: forecast
```

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

–í —Ñ—É–Ω–∫—Ü–∏–∏ `button_callback` –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è:

```python
elif callback_data == "risk_metrics" or callback_data == "risk_metrics_compare" or callback_data == "compare_risk_metrics":
    self.logger.info("Risk metrics button clicked")
    # Get data from user context
    user_id = update.effective_user.id
    user_context = self._get_user_context(user_id)
    symbols = user_context.get('current_symbols', [])
    await self._handle_risk_metrics_button(update, context, symbols)

elif callback_data == "monte_carlo" or callback_data == "monte_carlo_compare" or callback_data == "compare_monte_carlo":
    self.logger.info("Monte Carlo button clicked")
    # Get data from user context
    user_id = update.effective_user.id
    user_context = self._get_user_context(user_id)
    symbols = user_context.get('current_symbols', [])
    await self._handle_monte_carlo_button(update, context, symbols)

elif callback_data == "forecast" or callback_data == "forecast_compare" or callback_data == "compare_forecast":
    self.logger.info("Forecast button clicked")
    # Get data from user context
    user_id = update.effective_user.id
    user_context = self._get_user_context(user_id)
    symbols = user_context.get('current_symbols', [])
    await self._handle_forecast_button(update, context, symbols)
```

### 2. –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `test_simple_regression.py` —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö mock –æ–±—ä–µ–∫—Ç–æ–≤:

- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤ –∏ –≤–µ—Å–æ–≤
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Okama
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AI —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –°—Ç–∏–ª–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –∫–æ–º–∞–Ω–¥—ã /test
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback —Ñ—É–Ω–∫—Ü–∏–π

### 3. –û–±–Ω–æ–≤–ª–µ–Ω test_runner.py

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–ø —Ç–µ—Å—Ç–∞ `simple`:

```python
self.test_modules = {
    'comprehensive': 'test_comprehensive_regression',
    'simple': 'test_simple_regression',  # –ù–æ–≤—ã–π –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
    'portfolio_risk': 'test_portfolio_risk_metrics_fix',
    'additional_metrics': 'test_additional_metrics_calculation',
    'hk_comparison': 'test_hk_comparison_debug',
    'test_command': 'test_test_command'
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ /test

- –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø —Ç–µ—Å—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å `quick` –Ω–∞ `simple`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–∞ `simple` –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–ø—Ä–∞–≤–∫–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/start`

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `_save_user_context` ‚Üí `_update_user_context`
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ mock –æ–±—ä–µ–∫—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `simple` –≤ argparse

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–°—Ç–∞—Ç—É—Å: –ü—Ä–æ–≤–∞–ª–µ–Ω—ã
–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 5.5 —Å–µ–∫
WARNING - Unknown button callback: risk_metrics
WARNING - Unknown button callback: monte_carlo  
WARNING - Unknown button callback: forecast
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–°—Ç–∞—Ç—É—Å: –ü—Ä–æ–π–¥–µ–Ω—ã
–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 6.0 —Å–µ–∫
INFO - Risk metrics button clicked
INFO - Monte Carlo button clicked
INFO - Forecast button clicked
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç (100% —É—Å–ø–µ—Ö)
```bash
python3 tests/test_runner.py --test simple
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ
‚úÖ simple (6.04s)
```

### –ü—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
```bash
python3 -c "import asyncio; from bot import ShansAi; ..."
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ö–æ–º–∞–Ω–¥–∞ /test –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
```

## üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----|----------|--------|
| `simple` | –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `quick` | –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `regression` | –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ |
| `all` | –í—Å–µ —Ç–µ—Å—Ç—ã | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ |
| `comprehensive` | –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ |

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```
/test
```
–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –° —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞
```
/test simple
/test quick
/test regression
/test all
/test comprehensive
```

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–†–∞–±–æ—Ç–∞—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞** - `/test` —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã** - –ø—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ ~6 —Å–µ–∫—É–Ω–¥
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ—Ç –æ—à–∏–±–æ–∫ "Unknown button callback"
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - —á–µ—Ç–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞** - –ª–µ–≥–∫–æ –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

### –î–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - —Ç–µ—Å—Ç—ã –∫–∞–∫ –∂–∏–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ **CI/CD –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–æ–º–∞–Ω–¥–∞ `/test` —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ **–í—Å–µ callback —Ñ—É–Ω–∫—Ü–∏–∏** —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç** –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞ 100%
- ‚úÖ **–ö–æ–º–∞–Ω–¥–∞ /test** –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ **Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–ö–æ–º–∞–Ω–¥–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞.

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2024-12-19  
**–í–µ—Ä—Å–∏—è**: 1.1  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**: 100%
