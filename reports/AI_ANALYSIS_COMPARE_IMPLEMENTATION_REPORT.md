# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ AI-–∞–Ω–∞–ª–∏–∑–∞ –≤ –∫–æ–º–∞–Ω–¥–µ /compare

## üéØ –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "AI-–∞–Ω–∞–ª–∏–∑" –∫ –∫–æ–º–∞–Ω–¥–µ `/compare`, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç –≤ –º–æ–¥–µ–ª—å Gemini:
- –ò—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω –∞–∫—Ç–∏–≤–æ–≤ –∏–∑ okama
- –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ "–ú–µ—Ç—Ä–∏–∫–∏"
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∏–≤–∏–¥–µ–Ω–¥–∞—Ö
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini

## ‚úÖ –°—Ç–∞—Ç—É—Å: –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å AI-–∞–Ω–∞–ª–∏–∑–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare` **—É–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞** –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîç –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ö–Ω–æ–ø–∫–∞ "–ê–Ω–∞–ª–∏–∑ Gemini" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 3770 –∏ 7840
- **Callback data**: `data_analysis_compare`
- **–£—Å–ª–æ–≤–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ Gemini —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω
- **–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏**: "–ê–Ω–∞–ª–∏–∑ Gemini"

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ callback'–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- **–§—É–Ω–∫—Ü–∏—è**: `_handle_data_analysis_compare_button` (—Å—Ç—Ä–æ–∫–∞ 6089)
- **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è**: –í —Ñ—É–Ω–∫—Ü–∏–∏ `button_callback` (—Å—Ç—Ä–æ–∫–∞ 5652)
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **–§—É–Ω–∫—Ü–∏—è**: `_prepare_data_for_analysis` (—Å—Ç—Ä–æ–∫–∞ 6558)
- **–ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ**:
  - ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –∞–∫—Ç–∏–≤–æ–≤ –∏–∑ okama
  - ‚úÖ –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ (CAGR, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–æ—Ä—Ç–∏–Ω–æ)
  - ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏–≤–∏–¥–µ–Ω–¥–∞—Ö (—á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É describe)
  - ‚úÖ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
  - ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫—Ç–∏–≤–∞—Ö

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gemini
- **–°–µ—Ä–≤–∏—Å**: `GeminiService.analyze_data()` (—Å—Ç—Ä–æ–∫–∞ 6118)
- **–ü—Ä–æ–º–ø—Ç**: –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞**: –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## üìä –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ Gemini

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```python
data_info = {
    'symbols': symbols,                    # –°–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤ –∞–∫—Ç–∏–≤–æ–≤
    'currency': currency,                  # –í–∞–ª—é—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    'period': '–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö',
    'performance': {},                     # –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    'correlations': [],                    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    'describe_table': describe_table,     # –¢–∞–±–ª–∏—Ü–∞ describe —Å –¥–∏–≤–∏–¥–µ–Ω–¥–∞–º–∏
    'asset_count': len(symbols),          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–æ–≤
    'analysis_type': 'asset_comparison',  # –¢–∏–ø –∞–Ω–∞–ª–∏–∑–∞
    'asset_names': {}                     # –ù–∞–∑–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤
}
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞
- **total_return**: –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- **annual_return**: –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)
- **volatility**: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (–∞–Ω–Ω—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
- **sharpe_ratio**: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
- **sortino_ratio**: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–æ—Ä—Ç–∏–Ω–æ
- **max_drawdown**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞**: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏
- **–¢–∞–±–ª–∏—Ü–∞ describe**: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ okama (–≤–∫–ª—é—á–∞–µ—Ç –¥–∏–≤–∏–¥–µ–Ω–¥—ã)
- **–ù–∞–∑–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤**: –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤

## ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è Gemini

Gemini –ø–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –∞–Ω–∞–ª–∏–∑—É:

1. **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–æ–≤**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º
2. **–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫-–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å**: –û—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–∏—Å–∫-–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
3. **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑**: –û—Ü–µ–Ω–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –∏ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. **–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞–∫—Ç–∏–≤–∞–º
5. **–°–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ Gemini
```
‚úÖ Gemini —Å–µ—Ä–≤–∏—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ Gemini –¥–æ—Å—Ç—É–ø–µ–Ω: True
‚úÖ API –∫–ª—é—á —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: True
```

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
```
‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å 7 —Å—Ç—Ä–æ–∫–∞–º–∏ –∫–Ω–æ–ø–æ–∫
‚úÖ –ö–Ω–æ–ø–∫–∞ AI-–∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–π–¥–µ–Ω–∞: –ê–Ω–∞–ª–∏–∑ Gemini -> data_analysis_compare
```

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
```
‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ _handle_data_analysis_compare_button –Ω–∞–π–¥–µ–Ω
‚úÖ –§—É–Ω–∫—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
‚úÖ –§—É–Ω–∫—Ü–∏—è _prepare_data_for_analysis –Ω–∞–π–¥–µ–Ω–∞
‚úÖ –§—É–Ω–∫—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
```

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å AI-–∞–Ω–∞–ª–∏–∑–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare` —É–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
1. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/compare` —Å –∞–∫—Ç–∏–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/compare SPY.US QQQ.US`)
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ê–Ω–∞–ª–∏–∑ Gemini" –≤ –ø–æ—è–≤–∏–≤—à–µ–π—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
3. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini, –≤–∫–ª—é—á–∞—é—â–∏–π:
   - –ò—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω –∞–∫—Ç–∏–≤–æ–≤
   - –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∏–≤–∏–¥–µ–Ω–¥–∞—Ö
   - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
   - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ.

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–§–∞–π–ª—ã**: `bot.py`, `services/gemini_service.py`
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**: 
  - `_create_compare_command_keyboard()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
  - `_handle_data_analysis_compare_button()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è
  - `_prepare_data_for_analysis()` - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  - `GeminiService.analyze_data()` - –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- **Callback data**: `data_analysis_compare`
- **–£—Å–ª–æ–≤–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è**: `self.gemini_service.is_available()`
