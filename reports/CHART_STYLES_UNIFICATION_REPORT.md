# Chart Styles Unification Report

## –û–±–∑–æ—Ä

**–î–∞—Ç–∞:** 2025-09-07  
**–ó–∞–¥–∞—á–∞:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑ `chart_styles.py`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## –ü—Ä–æ–±–ª–µ–º–∞

–ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä—è–º–æ–≥–æ matplotlib –∫–æ–¥–∞ –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–∑ `chart_styles.py`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫:

- –ù–µ–µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–º—É —Å—Ç–∏–ª—é –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ–¥–∞ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∏–ª–µ–π
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏—é –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

## –†–µ—à–µ–Ω–∏–µ

### 1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_create_hybrid_chinese_comparison`

**–§–∞–π–ª:** `bot.py`

**–î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ matplotlib –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π, —Ü–≤–µ—Ç–æ–≤, –ª–µ–≥–µ–Ω–¥—ã
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
fig, ax = self.chart_styles.create_comparison_chart(
    data=comparison_df,
    symbols=list(comparison_data.keys()),
    currency=currency,
    title=title,
    xlabel='',  # –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å –æ—Å–∏ X
    ylabel=''   # –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å –æ—Å–∏ Y
)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å—Ç–∏–ª–µ–π
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ –õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `create_comparison_chart`

**–§–∞–π–ª:** `services/chart_styles.py`

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ú–µ—Ç–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `title`, `xlabel`, `ylabel`
- –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `plt.subplots`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
def create_comparison_chart(self, data, symbols, currency, **kwargs):
    """–°–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤"""
    fig, ax = self.create_chart(**kwargs)
    
    # ... –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ ...
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ kwargs
    title = kwargs.get('title', f'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤: {", ".join(symbols)}')
    xlabel = kwargs.get('xlabel', '')
    ylabel = kwargs.get('ylabel', f'–ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å ({currency})' if currency else '–ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏
    self.apply_styling(ax, title=title, xlabel=xlabel, ylabel=ylabel)
    ax.tick_params(axis='x', rotation=45)
    
    return fig, ax
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `create_chart`:**
```python
# –£–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è plt.subplots
plot_kwargs = {k: v for k, v in kwargs.items() if k not in ['copyright', 'title', 'xlabel', 'ylabel']}
```

### 3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/info` –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã

–ú–µ—Ç–æ–¥ `_handle_tushare_info` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:
- `_get_tushare_daily_chart` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `chart_styles.create_price_chart`
- `_get_tushare_monthly_chart` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `chart_styles.create_price_chart`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –¢–µ—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
```python
# Test create_comparison_chart method
fig, ax = chart_styles.create_comparison_chart(
    data=data,
    symbols=['Symbol1', 'Symbol2'],
    currency='CNY',
    title='Test Comparison',
    xlabel='',
    ylabel=''
)
# ‚úÖ create_comparison_chart works
```

### ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å—Ç–∏–ª–µ–π

–¢–µ–ø–µ—Ä—å –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏–∑ `chart_styles.py`
- –ï–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã –∏ —Å–µ—Ç–∫–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫–æ–ø–∏—Ä–∞–π—Ç
- –ï–¥–∏–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã DPI –∏ –∫–∞—á–µ—Å—Ç–≤–∞

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã `chart_styles.py`:

1. **`create_price_chart`** - –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Ü–µ–Ω
2. **`create_comparison_chart`** - –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤
3. **`create_dividends_chart`** - –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤
4. **`create_drawdowns_chart`** - –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø—Ä–æ—Å–∞–¥–æ–∫
5. **`create_correlation_matrix_chart`** - –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏:

- **–¶–≤–µ—Ç–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø–∞–ª–∏—Ç—Ä—ã
- **–®—Ä–∏—Ñ—Ç—ã:** CJK-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —à—Ä–∏—Ñ—Ç—ã –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- **–†–∞–∑–º–µ—Ä—ã:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —Ñ–∏–≥—É—Ä (14x8)
- **DPI:** 300 –¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
- **–ö–æ–ø–∏—Ä–∞–π—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏

### üé® **–ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å**
- –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤—ã–≥–ª—è–¥—è—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏ —à—Ä–∏—Ñ—Ç—ã
- –ï–¥–∏–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã –∏ —Å–µ—Ç–∫–∏

### üîß **–£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### üìà **–ö–∞—á–µ—Å—Ç–≤–æ –≥—Ä–∞—Ñ–∏–∫–æ–≤**
- –í—ã—Å–æ–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (300 DPI)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ

### üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚úÖ **–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ:**

–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑ `chart_styles.py`:

1. **`_create_hybrid_chinese_comparison`** ‚Üí `create_comparison_chart`
2. **`/info` –∫–æ–º–∞–Ω–¥–∞** ‚Üí `create_price_chart` (—É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è)
3. **–ö–Ω–æ–ø–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤** ‚Üí `create_price_chart` (—É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å)

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- üé® –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
- üîß –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞
- üìà –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- üöÄ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º —Å—Ç–∏–ª–µ–º –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–∫—Ç–∏–≤–æ–≤, –≤–∫–ª—é—á–∞—è –∫–∏—Ç–∞–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã.
