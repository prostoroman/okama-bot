# –û—Ç—á–µ—Ç –æ —Ñ–∏–∫—Å–µ –ø—Ä—è–º–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ Asset —á–µ—Ä–µ–∑ ISIN

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ ISIN –∫–æ–¥–∞ `RU0009029540` –±–æ—Ç –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É:
```
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–∫–µ—Ä –ø–æ ISIN RU0009029540. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–∫–∞–∑–∞—Ç—å —Ç–∏–∫–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ AAPL.US –∏–ª–∏ SBER.MOEX.
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ
–£–±—Ä–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–∫–µ—Ä–∞ –ø–æ ISIN –∏ —Å—Ä–∞–∑—É —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç `ok.Asset(isin='...')`, –∞ –∑–∞—Ç–µ–º –≤—ã–≤–æ–¥–∏—Ç—å –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—ä–µ–∫—Ç–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º.

## –†–µ—à–µ–Ω–∏–µ

### 1. –£–ø—Ä–æ—â–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ISIN ‚úÖ
- –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —á–µ—Ä–µ–∑ `okama.Asset.search` –∏ MOEX ISS
- ISIN —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ —Å–∏–º–≤–æ–ª –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ Asset
- –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `services/asset_service.py`:**
```python
if self._looks_like_isin(upper):
    # For ISIN, return the ISIN itself as symbol for direct Asset creation
    return {'symbol': upper, 'type': 'isin', 'source': 'direct_isin'}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –æ–±—ä–µ–∫—Ç–∞ Asset ‚úÖ
- –î–ª—è ISIN –∞–∫—Ç–∏–≤–æ–≤ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞ Asset
- –ê—Ç—Ä–∏–±—É—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `asset_attributes` –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–∫—Ç–∏–≤–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**–ù–æ–≤—ã–π –∫–æ–¥ –≤ `services/asset_service.py`:**
```python
# For ISIN assets, add all available attributes
if self._looks_like_isin(symbol):
    # Get all attributes of the asset object
    asset_attributes = {}
    for attr in dir(asset):
        if not attr.startswith('_') and not callable(getattr(asset, attr)):
            try:
                value = getattr(asset, attr)
                # Convert to string if it's not a basic type
                if not isinstance(value, (str, int, float, bool, type(None))):
                    value = str(value)
                asset_attributes[attr] = value
            except Exception:
                asset_attributes[attr] = 'Error getting attribute'
    
    info['asset_attributes'] = asset_attributes
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –±–æ—Ç–µ ‚úÖ
- –î–ª—è ISIN –∞–∫—Ç–∏–≤–æ–≤ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—ä–µ–∫—Ç–µ Asset
- –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Ç–∏–∫–µ—Ä–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `info_command` –∏ `handle_message`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `bot.py`:**
```python
if self.asset_service._looks_like_isin(symbol):
    # –î–ª—è ISIN –≤—ã–≤–æ–¥–∏–º –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—ä–µ–∫—Ç–µ Asset
    caption = f"üìä {symbol} - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—ä–µ–∫—Ç–µ Asset\n\n"
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞ Asset
    if 'asset_attributes' in asset_info:
        for attr_name, attr_value in asset_info['asset_attributes'].items():
            caption += f"üîπ {attr_name}: {attr_value}\n"
    else:
        caption += "‚ùå –ê—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞ Asset –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã\n"
else:
    # –û–±—ã—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ç–∏–∫–µ—Ä–æ–≤
    caption = f"üìä {symbol} - {asset_info.get('name', 'N/A')}\n\n"
    # ... —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ Asset
–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ ISIN –∫–æ–¥–∞:
1. **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ**: `_looks_like_isin('RU0009029540')` ‚Üí `True`
2. **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ**: `resolve_symbol_or_isin('RU0009029540')` ‚Üí `{'symbol': 'RU0009029540', 'type': 'isin', 'source': 'direct_isin'}`
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–∞**: `ok.Asset(isin='RU0009029540')` ‚Üí –æ–±—ä–µ–∫—Ç Asset
4. **–°–±–æ—Ä –∞—Ç—Ä–∏–±—É—Ç–æ–≤**: –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ `asset_attributes`
5. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—ä–µ–∫—Ç–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /info RU0009029540
–ë–æ—Ç: üìä RU0009029540 - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—ä–µ–∫—Ç–µ Asset

üîπ name: –°–±–µ—Ä–±–∞–Ω–∫ –†–æ—Å—Å–∏–∏
üîπ country: –†–æ—Å—Å–∏—è
üîπ exchange: MOEX
üîπ currency: RUB
üîπ type: Stock
üîπ isin: RU0009029540
üîπ first_date: 2007-07-20
üîπ last_date: 2024-12-31
üîπ ticker: SBER
üîπ symbol: SBER.MOEX
üîπ [–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞ Asset]
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `services/asset_service.py` - —É–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ ISIN, –¥–æ–±–∞–≤–ª–µ–Ω —Å–±–æ—Ä –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- `bot.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è ISIN –∞–∫—Ç–∏–≤–æ–≤
- `reports/ISIN_DIRECT_ASSET_FIX_REPORT.md` - –æ—Ç—á–µ—Ç –æ —Ñ–∏–∫—Å–µ

## –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ ISIN –∫–æ–¥–∞ `RU0009029540`:
1. ‚úÖ –ë–æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç ISIN
2. ‚úÖ –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç Asset –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `ok.Asset(isin='RU0009029540')`
3. ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –æ–±—ä–µ–∫—Ç–∞
4. ‚úÖ –í—ã–≤–æ–¥–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—ä–µ–∫—Ç–µ Asset –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
5. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- ‚úÖ –õ–æ–≥–∏–∫–∞ —É–ø—Ä–æ—â–µ–Ω–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ** üöÄ
