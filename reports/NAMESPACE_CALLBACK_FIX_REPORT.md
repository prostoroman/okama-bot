# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ callback —Å–æ–æ–±—â–µ–Ω–∏–π

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç–æ–¥–æ–≤ namespace –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞:
```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 'US': OkamaFinanceBot._send_callback_message() got an unexpected keyword argument 'reply_markup'
```

## –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏
–ú–µ—Ç–æ–¥ `_send_callback_message` –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `reply_markup`, –Ω–æ –≤ –µ–¥–∏–Ω–æ–º –º–µ—Ç–æ–¥–µ `_show_namespace_symbols` –º—ã –ø—ã—Ç–∞–ª–∏—Å—å –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –¥–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π.

### –ê–Ω–∞–ª–∏–∑ –º–µ—Ç–æ–¥–∞ `_send_callback_message`:
```python
async def _send_callback_message(self, update: Update, context: ContextTypes.DEFAULT_TYPE, text: str, parse_mode: str = None):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ callback query"""
    # –ú–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ text –∏ parse_mode, –Ω–æ –Ω–µ reply_markup
```

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_show_namespace_symbols`
**–§–∞–π–ª**: `bot.py`  
**–°—Ç—Ä–æ–∫–∏**: 494-593

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –í–°–ï –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `_send_callback_message`:

##### –ú–µ—Å—Ç–æ 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ DataFrame
**–ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
if symbols_df.empty:
    error_msg = f"‚ùå –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω '{namespace}' –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –ø—É—Å—Ç–æ"
    if is_callback:
        await self._send_callback_message(update, context, error_msg)
    else:
        await self._send_message_safe(update, error_msg)
    return
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
if symbols_df.empty:
    error_msg = f"‚ùå –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω '{namespace}' –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –ø—É—Å—Ç–æ"
    if is_callback:
        # –î–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ context.bot
        await context.bot.send_message(
            chat_id=update.callback_query.message.chat_id,
            text=error_msg
        )
    else:
        await self._send_message_safe(update, error_msg)
    return
```

##### –ú–µ—Å—Ç–æ 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏
**–ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–∞–±–ª–∏—Ü–µ–π –∏ –∫–Ω–æ–ø–∫–æ–π
if is_callback:
    await self._send_callback_message(update, context, response, reply_markup=reply_markup)
else:
    await self._send_message_safe(update, response, reply_markup=reply_markup)
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–∞–±–ª–∏—Ü–µ–π –∏ –∫–Ω–æ–ø–∫–æ–π
if is_callback:
    # –î–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ context.bot —Å –∫–Ω–æ–ø–∫–∞–º–∏
    await context.bot.send_message(
        chat_id=update.callback_query.message.chat_id,
        text=response,
        reply_markup=reply_markup
    )
else:
    await self._send_message_safe(update, response, reply_markup=reply_markup)
```

##### –ú–µ—Å—Ç–æ 3: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –∫–Ω–æ–ø–æ–∫
**–ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
else:
    response += f"üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/info <—Å–∏–º–≤–æ–ª>` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–∫—Ç–∏–≤–µ"
    if is_callback:
        await self._send_callback_message(update, context, response)
    else:
        await self._send_message_safe(update, response)
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
else:
    response += f"üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/info <—Å–∏–º–≤–æ–ª>` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–∫—Ç–∏–≤–µ"
    if is_callback:
        # –î–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ context.bot
        await context.bot.send_message(
            chat_id=update.callback_query.message.chat_id,
            text=response
        )
    else:
        await self._send_message_safe(update, response)
```

##### –ú–µ—Å—Ç–æ 4: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
**–ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
error_msg = f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è '{namespace}': {str(e)}"
if is_callback:
    await self._send_callback_message(update, context, error_msg)
else:
    await self._send_message_safe(update, error_msg)
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)**:
```python
error_msg = f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è '{namespace}': {str(e)}"
if is_callback:
    # –î–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ context.bot
    await context.bot.send_message(
        chat_id=update.callback_query.message.chat_id,
        text=error_msg
    )
else:
    await self._send_message_safe(update, error_msg)
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –î–ª—è callback —Å–æ–æ–±—â–µ–Ω–∏–π:
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `context.bot.send_message` –Ω–∞–ø—Ä—è–º—É—é
- –ü–æ–ª—É—á–∞–µ–º `chat_id` –∏–∑ `update.callback_query.message.chat_id`
- –ü–µ—Ä–µ–¥–∞–µ–º `reply_markup` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)

### –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `_send_message_safe` –∫–∞–∫ –æ–±—ã—á–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 2. –ì–∏–±–∫–æ—Å—Ç—å
- –†–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 3. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ù–µ –Ω–∞—Ä—É—à–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. **–ö–æ–º–∞–Ω–¥–∞ `/namespace US`**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ø-30 —Å–∏–º–≤–æ–ª–æ–≤
   - ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É Excel

2. **–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É namespace**
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ø-30 —Å–∏–º–≤–æ–ª–æ–≤
   - ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É Excel

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

4. **–ü—É—Å—Ç—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω**
   - ‚úÖ –î–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
- ‚úÖ –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ü–æ–∫–∞–∑ —Ç–æ–ø-30 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ö–Ω–æ–ø–∫–∞ Excel
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### –£–ª—É—á—à–µ–Ω–∏—è:
- üîÑ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback —Å–æ–æ–±—â–µ–Ω–∏–π
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–Ω–æ–ø–æ–∫ –≤ callback
- üîÑ –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
- üîÑ –ü–æ–ª–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å `reply_markup`

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—à–∏–±–∫–∞ —Å `reply_markup` –≤ callback —Å–æ–æ–±—â–µ–Ω–∏—è—Ö **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ê**. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ callback —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –∫–Ω–æ–ø–∫–∞–º–∏  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π  
‚úÖ **–ü–æ–ª–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ** –≤—Å–µ—Ö –º–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `_send_callback_message` —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏  
‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** namespace –∫–æ–º–∞–Ω–¥  
‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –∫–æ–¥–∞  
‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏  

–¢–µ–ø–µ—Ä—å –∫–æ–º–∞–Ω–¥–∞ `/namespace` —Ä–∞–±–æ—Ç–∞–µ—Ç **–ò–î–ï–ê–õ–¨–ù–û**:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ø-30 —Å–∏–º–≤–æ–ª–æ–≤ (–Ω–µ –ø–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–Ω–æ–ø–∫—É Excel (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –í–°–ï callback —Å–æ–æ–±—â–µ–Ω–∏—è**
- **–ù–ï–¢ –û–®–ò–ë–û–ö** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–¥–∏–Ω—É—é –ª–æ–≥–∏–∫—É –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö
- –ö–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã, –≤—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
