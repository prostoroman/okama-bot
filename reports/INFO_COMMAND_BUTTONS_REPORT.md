# –û—Ç—á–µ—Ç –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã /info —Å –∫–Ω–æ–ø–∫–∞–º–∏

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 03.09.2025  
**–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 30 –º–∏–Ω—É—Ç  
**–°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

## –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –ü–µ—Ä–µ–Ω–æ—Å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É ‚úÖ

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –±–æ–ª—å—à–µ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –∫–æ–º–∞–Ω–¥–µ `/info`, –∞ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É.

**–î–æ**:
- –ö–æ–º–∞–Ω–¥–∞ `/info` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
- –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∞–∫—Ç–∏–≤–µ
- –ö–Ω–æ–ø–∫–∏ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≥—Ä–∞—Ñ–∏–∫–∞

**–ü–æ—Å–ª–µ**:
- –ö–æ–º–∞–Ω–¥–∞ `/info` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "üìà –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (1Y)"
- –í—Å–µ –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ ISIN –≤ –∫–æ–º–∞–Ω–¥–µ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚úÖ

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –ö–æ–º–∞–Ω–¥–∞ `/info` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ ISIN –∫–æ–¥–æ–≤.

**–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç**:
```
üìä –ö–æ–º–∞–Ω–¥–∞ /info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫—Ç–∏–≤–µ

–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: SBER.MOEX, SPY.US, AAPL.US

üí° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:
‚Ä¢ –°–∏–º–≤–æ–ª—ã: SBER.MOEX, AAPL.US, SPY.US
‚Ä¢ ISIN –∫–æ–¥—ã: RU0009029540 (–°–±–µ—Ä–±–∞–Ω–∫), US0378331005 (Apple)

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏.
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `/info` ‚úÖ

**–£–±—Ä–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞**:
```python
# –£–±—Ä–∞–Ω–æ:
# –ü–æ–ª—É—á–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (1Y)
await self._send_message_safe(update, "üìà –ü–æ–ª—É—á–∞—é –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫...")
daily_chart = await self._get_daily_chart(symbol)
```

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞**:
```python
keyboard = [
    [
        InlineKeyboardButton("üìà –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (1Y)", callback_data=f"daily_chart_{symbol}"),
        InlineKeyboardButton("üìÖ –ú–µ—Å—è—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (10Y)", callback_data=f"monthly_chart_{symbol}")
    ],
    [
        InlineKeyboardButton("üíµ –î–∏–≤–∏–¥–µ–Ω–¥—ã", callback_data=f"dividends_{symbol}")
    ]
]
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ ‚úÖ

**–ù–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫**:
```python
async def _handle_daily_chart_button(self, update: Update, context: ContextTypes.DEFAULT_TYPE, symbol: str):
    """Handle daily chart button click for single asset"""
    try:
        await self._send_callback_message(update, context, "üìà –ü–æ–ª—É—á–∞—é –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–∞ 1 –≥–æ–¥...")
        
        # –ü–æ–ª—É—á–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –∑–∞ 1 –≥–æ–¥
        daily_chart = await self._get_daily_chart(symbol)
        
        if daily_chart:
            caption = f"üìà –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ {symbol} –∑–∞ 1 –≥–æ–¥\n\n"
            caption += "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å"
            
            await update.callback_query.message.reply_photo(
                photo=daily_chart,
                caption=self._truncate_caption(caption)
            )
        else:
            await self._send_callback_message(update, context, "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫")
            
    except Exception as e:
        self.logger.error(f"Error handling daily chart button: {e}")
        await self._send_callback_message(update, context, f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞: {str(e)}")
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π ‚úÖ

**–£–±—Ä–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞** –≤ `handle_message`:
- –£–±—Ä–∞–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
- –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ISIN –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚úÖ
```
Testing ISIN: RU0009029540
resolve_symbol_or_isin(RU0009029540): {'symbol': 'SBER.MOEX', 'type': 'isin', 'source': 'okama_search'}
‚úÖ get_asset_info successful
   Name: Sberbank Rossii PAO
   Currency: RUB
   Exchange: MOEX
   ISIN: RU0009029540
```

### –ö–Ω–æ–ø–∫–∏ ‚úÖ
```
Testing button data generation...
   Daily chart button: daily_chart_SBER.MOEX
   Monthly chart button: monthly_chart_SBER.MOEX
   Dividends button: dividends_SBER.MOEX
‚úÖ Button data format is correct
```

### –ü—Ä–æ—Å—Ç—ã–µ —Ç–∏–∫–µ—Ä—ã ‚úÖ
```
resolve_symbol_or_isin(AAPL): {'symbol': 'AAPL', 'type': 'ticker', 'source': 'plain'}
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ö–æ–º–∞–Ω–¥–∞ `/info` —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ (–Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –≥—Ä–∞—Ñ–∏–∫
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### 2. –£–ª—É—á—à–µ–Ω–∏–µ UX
- –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫ –∫–æ–º–∞–Ω–¥—ã `/info`
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–Ω–æ–ø–∫–∞–º–∏

### 3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ISIN
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–Ω–∞—é—Ç –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ ISIN –∫–æ–¥–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã ISIN –∫–æ–¥–æ–≤ –≤ —Å–ø—Ä–∞–≤–∫–µ
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `bot.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/info`, –¥–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
- `tests/test_info_command_buttons.py` - —Å–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `reports/INFO_COMMAND_BUTTONS_REPORT.md` - –æ—Ç—á–µ—Ç –æ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –º–µ—Ç–æ–¥–æ–≤**: 1 (`_handle_daily_chart_button`)
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ –º–µ—Ç–æ–¥–æ–≤**: 2 (`info_command`, `handle_message`)
- **–£–±—Ä–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –∫–Ω–æ–ø–æ–∫**: 1 (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫)
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 30 –º–∏–Ω—É—Ç

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/info` –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ –∫–Ω–æ–ø–∫—É
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –æ ISIN
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ** üöÄ
