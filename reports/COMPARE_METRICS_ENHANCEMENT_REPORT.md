# –û—Ç—á–µ—Ç –æ–± —É–ª—É—á—à–µ–Ω–∏–∏ –º–µ—Ç—Ä–∏–∫ –∫–æ–º–∞–Ω–¥—ã /compare

## üéØ –¶–µ–ª—å
–£–ª—É—á—à–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –º–µ—Ç—Ä–∏–∫ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare` —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –î–æ–±–∞–≤–∏—Ç—å –≤ –ø–µ—Ä–≤—É—é —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ "–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR)" —Å—Ç—Ä–æ–∫–∏:
   - "–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 1 –≥–æ–¥"
   - "–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 5 –ª–µ—Ç"
2. –í–æ –≤—Ç–æ—Ä—É—é —Ç–∞–±–ª–∏—Ü—É –≤–º–µ—Å—Ç–æ –Ω–æ–º–µ—Ä–æ–≤ –º–µ—Ç—Ä–∏–∫ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è (property)

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CAGR 1 –≥–æ–¥ –∏ CAGR 5 –ª–µ—Ç

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 8300-8328

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–≤–µ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –º–µ—Ç—Ä–∏–∫ –ø–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω–æ–π CAGR
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞—Å—á–µ—Ç CAGR –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 12 –º–µ—Å—è—Ü–µ–≤ (1 –≥–æ–¥)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞—Å—á–µ—Ç CAGR –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 60 –º–µ—Å—è—Ü–µ–≤ (5 –ª–µ—Ç)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤ —Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–¥**:
```python
# CAGR 1 year row
cagr_1y_row = ["–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 1 –≥–æ–¥"]
for symbol in symbols:
    cagr_1y = metrics_data.get(symbol, {}).get('cagr_1y')
    if cagr_1y is not None:
        cagr_1y_row.append(f"{cagr_1y*100:.2f}%")
    else:
        cagr_1y_row.append("N/A")
table_data.append(cagr_1y_row)

# CAGR 5 years row
cagr_5y_row = ["–°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 5 –ª–µ—Ç"]
for symbol in symbols:
    cagr_5y = metrics_data.get(symbol, {}).get('cagr_5y')
    if cagr_5y is not None:
        cagr_5y_row.append(f"{cagr_5y*100:.2f}%")
    else:
        cagr_5y_row.append("N/A")
table_data.append(cagr_5y_row)
```

**–†–∞—Å—á–µ—Ç CAGR 1–≥ –∏ 5–ª**:
```python
# CAGR 1 year (last 12 months)
if len(prices) >= 12:
    prices_1y = prices.tail(12)
    if len(prices_1y) > 1:
        total_return_1y = (prices_1y.iloc[-1] / prices_1y.iloc[0]) - 1
        symbol_metrics['cagr_1y'] = (1 + total_return_1y) ** (12 / len(prices_1y)) - 1

# CAGR 5 years (last 60 months)
if len(prices) >= 60:
    prices_5y = prices.tail(60)
    if len(prices_5y) > 1:
        total_return_5y = (prices_5y.iloc[-1] / prices_5y.iloc[0]) - 1
        symbol_metrics['cagr_5y'] = (1 + total_return_5y) ** (12 / len(prices_5y)) - 1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –≤–∏–¥—è—Ç CAGR –∑–∞ 1 –≥–æ–¥ –∏ 5 –ª–µ—Ç –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –ø–æ–ª–Ω–æ–º—É –ø–µ—Ä–∏–æ–¥—É

### 2. –ó–∞–º–µ–Ω–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 8464-8491

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_describe_table`
- –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ (0, 1, 2, ...) —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ 'property'
- –£–ª—É—á—à–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –º–µ—Ç—Ä–∏–∫

**–ö–æ–¥**:
```python
# Use property names instead of numeric indices
for idx in describe_data.index:
    property_name = describe_data.loc[idx, 'property']
    row = [str(property_name)]  # Use property name instead of numeric index
    for symbol in symbols:
        if symbol in describe_data.columns:
            value = describe_data.loc[idx, symbol]
            # Format based on metric type
            if isinstance(value, (int, float)):
                if 'return' in str(property_name).lower() or 'cagr' in str(property_name).lower():
                    row.append(f"{value*100:.2f}%")
                elif 'volatility' in str(property_name).lower() or 'risk' in str(property_name).lower():
                    row.append(f"{value*100:.2f}%")
                # ... other formatting rules
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫**:
- Compound return
- CAGR (–¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤)
- Annualized mean return
- Dividend yield
- Risk
- CVAR
- Max drawdowns
- Max drawdowns dates
- Inception date
- Last asset date
- Common last data date

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∞–π–ª —Ç–µ—Å—Ç–∞**: `tests/test_compare_metrics_enhancement.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
- ‚úÖ CAGR 1 –≥–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É
- ‚úÖ CAGR 5 –ª–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É  
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
- ‚úÖ –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü—ã –º–µ—Ç—Ä–∏–∫**:
```
| –ú–µ—Ç—Ä–∏–∫–∞                         | SPY.US   | QQQ.US   |
|:--------------------------------|:---------|:---------|
| –ü–µ—Ä–∏–æ–¥ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π               | 32.7 –ª–µ—Ç | 26.5 –ª–µ—Ç |
| –°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 1 –≥–æ–¥  | 15.61%   | 21.25%   |
| –°—Ä–µ–¥–Ω. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) 5 –ª–µ—Ç  | 15.02%   | 16.84%   |
| –°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) | 8.64%    | 6.71%    |
| –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å                   | 14.84%   | 25.24%   |
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Ç–∞–±–ª–∏—Ü—ã describe**:
```
| –ú–µ—Ç—Ä–∏–∫–∞                | SPY.US   | QQQ.US   |
|:-----------------------|:---------|:---------|
| Compound return        | 10.71%   | 11.86%   |
| CAGR                   | 15.85%   | 20.43%   |
| CAGR                   | 14.68%   | 14.81%   |
| Annualized mean return | 9.44%    | 13.20%   |
| Dividend yield         | 1.11%    | 0.49%    |
| Risk                   | 16.56%   | 26.47%   |
```

## üìã –ò—Ç–æ–≥–∏

1. **–£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã** CAGR 1 –≥–æ–¥ –∏ CAGR 5 –ª–µ—Ç –≤ –ø–µ—Ä–≤—É—é —Ç–∞–±–ª–∏—Ü—É –º–µ—Ç—Ä–∏–∫
2. **–£—Å–ø–µ—à–Ω–æ –∑–∞–º–µ–Ω–µ–Ω—ã** —á–∏—Å–ª–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–∞–±–ª–∏—Ü–µ
3. **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã** –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

–ö–æ–º–∞–Ω–¥–∞ `/compare` —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –∏ –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.
