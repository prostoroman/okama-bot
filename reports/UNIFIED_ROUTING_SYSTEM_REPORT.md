# –û—Ç—á–µ—Ç –æ–± —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞, –∑–∞–º–µ–Ω–∏–≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ –æ–∂–∏–¥–∞–Ω–∏—è (`waiting_for_portfolio`, `waiting_for_info`, `waiting_for_compare`, `waiting_for_portfolio_weights`) –Ω–∞ –µ–¥–∏–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `waiting_for` —Å –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:

- `'portfolio'` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `'portfolio_weights'` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `'info'` - –æ–∂–∏–¥–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- `'compare'` - –æ–∂–∏–¥–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `'list'` - –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- `None` - –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è, fallback –Ω–∞ –ø–æ–∏—Å–∫

## –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –±–æ—Ç—É –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–≤–æ–¥–∞

### 1. –ö–æ–º–∞–Ω–¥–∞ `/info` - –ê–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–∫—Ç–∏–≤–µ

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/start ‚Üí /info ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–∞
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'info'` - –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/info` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
- `waiting_for = None` - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –ü—Ä–∏ `/info` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤: "üí¨ –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–∫–µ—Ä –∏–ª–∏ ISIN –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞"
- –ü—Ä–∏ –≤–≤–æ–¥–µ —Å–∏–º–≤–æ–ª–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏–∑

**Fallback:** –ï—Å–ª–∏ `waiting_for = None`, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–∞

### 2. –ö–æ–º–∞–Ω–¥–∞ `/compare` - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç —Å—Ä–∞–≤–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–æ–≤

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/start ‚Üí /compare ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'compare'` - –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/compare` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
- `compare_first_symbol` - —Ö—Ä–∞–Ω–∏—Ç –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `waiting_for = None` - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –ü—Ä–∏ `/compare` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤: "üí¨ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª:"
- –ü—Ä–∏ –≤–≤–æ–¥–µ –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞: "–í—ã —É–∫–∞–∑–∞–ª–∏ —Ç–æ–ª—å–∫–æ 1 —Å–∏–º–≤–æ–ª, –∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ 2 –∏ –±–æ–ª—å—à–µ, –Ω–∞–ø–∏—à–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞: "‚ùå –ú–∞–∫—Å–∏–º—É–º 5 –∞–∫—Ç–∏–≤–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–Ω–æ–≤–æ"

### 3. –ö–æ–º–∞–Ω–¥–∞ `/portfolio` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –≤–µ—Å–∞–º–∏

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/start ‚Üí /portfolio ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'portfolio'` - –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/portfolio` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
- `waiting_for = 'portfolio_weights'` - –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ —Ç–æ–ª—å–∫–æ —Ç–∏–∫–µ—Ä–æ–≤
- `portfolio_tickers` - —Ö—Ä–∞–Ω–∏—Ç —Ç–∏–∫–µ—Ä—ã –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `waiting_for = None` - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –ü—Ä–∏ `/portfolio` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤: "üí¨ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è:"
- –ü—Ä–∏ –≤–≤–æ–¥–µ —Ç–æ–ª—å–∫–æ —Ç–∏–∫–µ—Ä–æ–≤: "**–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å–∞ –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ:**"
- –ü—Ä–∏ –æ—à–∏–±–∫–µ: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `waiting_for = 'portfolio'`

### 4. –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤—ã –≤ –ø–æ—Ä—Ç—Ñ–µ–ª—å"

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/compare ‚Üí [—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã] ‚Üí [–∫–Ω–æ–ø–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è] ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'portfolio'` - –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `waiting_for = None` - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏: "üí¨ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è:"

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –∫–∏—Ç–∞–π—Å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/portfolio ‚Üí [–≤–≤–æ–¥ –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤] ‚Üí [—Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ] ‚Üí [–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤–≤–æ–¥ –ø–æ—Ä—Ç—Ñ–µ–ª—è]
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'portfolio'` - –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –ø–æ—Å–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–∞—Ö

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- "üöß **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ç–∞–π—Å–∫–∏—Ö –∏ –≥–æ–Ω–∫–æ–Ω–≥—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**"
- "üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å–Ω–æ–≤–∞:" (–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤–≤–æ–¥—É)

### 6. –ö–Ω–æ–ø–∫–∏ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ" –∏ "–í –ø–æ—Ä—Ç—Ñ–µ–ª—å" –≤ namespace

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ namespace

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
/list ‚Üí [–≤—ã–±–æ—Ä –±–∏—Ä–∂–∏] ‚Üí [–∫–Ω–æ–ø–∫–∞ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ"] ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
/list ‚Üí [–≤—ã–±–æ—Ä –±–∏—Ä–∂–∏] ‚Üí [–∫–Ω–æ–ø–∫–∞ "–í –ø–æ—Ä—Ç—Ñ–µ–ª—å"] ‚Üí [–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞] ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = 'compare'` - –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ"
- `waiting_for = 'portfolio'` - –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–í –ø–æ—Ä—Ç—Ñ–µ–ª—å"

**–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:**
- –ü–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ": "üí¨ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:"
- –ü–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏ "–í –ø–æ—Ä—Ç—Ñ–µ–ª—å": "üí¨ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è:"

### 7. Fallback –Ω–∞ –ø–æ–∏—Å–∫

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–ü—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
[–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç] ‚Üí [–ø–æ–∏—Å–∫] ‚Üí [–≤—ã–±–æ—Ä –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤] ‚Üí –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–∞
```

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- `waiting_for = None` - –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (–ø—Ä–æ–±–µ–ª/–∑–∞–ø—è—Ç–∞—è) ‚Üí —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
2. –û–¥–∏–Ω–æ—á–Ω—ã–π —Å–∏–º–≤–æ–ª ‚Üí –ø–æ–∏—Å–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí –º–µ–Ω—é –≤—ã–±–æ—Ä–∞
4. –û–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

## –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

### –§—É–Ω–∫—Ü–∏—è `handle_message`

```python
waiting_for = user_context.get('waiting_for')

if waiting_for == 'portfolio':
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
elif waiting_for == 'portfolio_weights':
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ—Å–æ–≤ –ø–æ—Ä—Ç—Ñ–µ–ª—è
elif waiting_for == 'info':
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
elif waiting_for == 'compare':
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
else:
    # Fallback –Ω–∞ –ø–æ–∏—Å–∫
```

### –§—É–Ω–∫—Ü–∏—è `_clear_all_waiting_flags`

```python
def _clear_all_waiting_flags(self, user_id: int):
    self._update_user_context(user_id, 
        waiting_for=None,
        portfolio_tickers=None,
        portfolio_base_symbols=None,
        compare_first_symbol=None,
        compare_base_symbol=None
    )
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ:** –û–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–ª–∞–≥–æ–≤
2. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** –ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –æ–∂–∏–¥–∞–µ—Ç –±–æ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –æ–∂–∏–¥–∞–Ω–∏—è
4. **–û—Ç–ª–∞–¥–∫–∞:** –ü—Ä–æ—â–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
5. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∏–∫–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞
```
/start ‚Üí /info ‚Üí "AAPL" ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
```
/start ‚Üí /portfolio ‚Üí "SPY QQQ" ‚Üí "0.6 0.4" ‚Üí –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å–æ–∑–¥–∞–Ω
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤
```
/start ‚Üí /compare ‚Üí "AAPL MSFT" ‚Üí —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ ‚Üí –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
```
/start ‚Üí "Tesla" ‚Üí –ø–æ–∏—Å–∫ ‚Üí –≤—ã–±–æ—Ä –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚Üí –∞–Ω–∞–ª–∏–∑
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
```
/portfolio ‚Üí "600017.SH" ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ ‚Üí "SPY QQQ" ‚Üí –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å–æ–∑–¥–∞–Ω
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ namespace
```
/list ‚Üí "US" ‚Üí [–∫–Ω–æ–ø–∫–∞ "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ"] ‚Üí "AAPL MSFT" ‚Üí —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
/list ‚Üí "US" ‚Üí [–∫–Ω–æ–ø–∫–∞ "–í –ø–æ—Ä—Ç—Ñ–µ–ª—å"] ‚Üí "SPY:0.6 QQQ:0.4" ‚Üí –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å–æ–∑–¥–∞–Ω
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–æ—Ç–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤–≤–æ–¥–∞
- –õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞.
