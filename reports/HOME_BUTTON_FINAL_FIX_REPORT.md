# –û—Ç—á–µ—Ç –æ–± –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ "–î–æ–º–æ–π"

## –ü—Ä–æ–±–ª–µ–º—ã
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∫–Ω–æ–ø–∫–∏**: –ö–Ω–æ–ø–∫–∞ "üè† –î–æ–º–æ–π" –Ω–µ –±—ã–ª–∞ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∫–Ω–æ–ø–æ–∫
2. **–û—à–∏–±–∫–∞ callback**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `update.message is None`
3. **–ù–µ—Ä–∞–±–æ—Ç–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ö–Ω–æ–ø–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞ –∫–æ–º–∞–Ω–¥—É `/list` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

### 1. –ü–æ–∑–∏—Ü–∏—è –∫–Ω–æ–ø–∫–∏
- –ö–Ω–æ–ø–∫–∞ "–î–æ–º–æ–π" –±—ã–ª–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∂–∏–¥–∞–ª —É–≤–∏–¥–µ—Ç—å –µ–µ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –≤–º–µ—Å—Ç–µ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

### 2. –û—à–∏–±–∫–∞ callback
- –§—É–Ω–∫—Ü–∏—è `namespace_command` –æ–∂–∏–¥–∞–µ—Ç `update.message`, –Ω–æ –ø—Ä–∏ callback –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ `update.callback_query`
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ—à–∏–±–∫–µ `Cannot send message: update.message is None`

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—ã—Ç–∞–ª—Å—è –≤—ã–∑–≤–∞—Ç—å `namespace_command` –Ω–∞–ø—Ä—è–º—É—é, —á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ callback –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

## –†–µ—à–µ–Ω–∏–µ

### 1. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –≤ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
**–§–∞–π–ª:** `bot.py`

**–í —Ñ—É–Ω–∫—Ü–∏–∏ `_show_namespace_symbols` (—Å—Ç—Ä–æ–∫–∏ 1865-1890):**
```python
# First row: Home button + Navigation buttons
first_row = [InlineKeyboardButton("üè† –î–æ–º–æ–π", callback_data="namespace_home")]

# Navigation buttons (only if more than one page)
if total_pages > 1:
    # Previous button
    if current_page > 0:
        first_row.append(InlineKeyboardButton(
            "‚¨ÖÔ∏è –ù–∞–∑–∞–¥", 
            callback_data=f"nav_namespace_{namespace}_{current_page - 1}"
        ))
    
    # Page indicator
    first_row.append(InlineKeyboardButton(
        f"{current_page + 1}/{total_pages}", 
        callback_data="noop"
    ))
    
    # Next button
    if current_page < total_pages - 1:
        first_row.append(InlineKeyboardButton(
            "‚û°Ô∏è –í–ø–µ—Ä–µ–¥", 
            callback_data=f"nav_namespace_{namespace}_{current_page + 1}"
        ))

keyboard.append(first_row)
```

**–í —Ñ—É–Ω–∫—Ü–∏–∏ `_show_tushare_namespace_symbols` (—Å—Ç—Ä–æ–∫–∏ 1729-1754):**
–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö –±–∏—Ä–∂.

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
**–§–∞–π–ª:** `bot.py` (—Å—Ç—Ä–æ–∫–∏ 12892-13015)

–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_handle_namespace_home_button`:
```python
async def _handle_namespace_home_button(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle namespace home button click - show main namespace list"""
    try:
        self.logger.info("Handling namespace home button")
        
        # Show available namespaces (same as /list command without args)
        import okama as ok
        namespaces = ok.namespaces
        
        # ... –ø–æ–ª–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã /list –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ...
        
        # Send message via callback
        await self._send_callback_message(update, context, response, reply_markup=reply_markup)
            
    except Exception as e:
        self.logger.error(f"Error handling namespace home button: {e}")
        await self._send_callback_message(update, context, f"‚ùå –û—à–∏–±–∫–∞: {str(e)}")
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ callback
**–§–∞–π–ª:** `bot.py` (—Å—Ç—Ä–æ–∫–∏ 5412-5414)

```python
elif callback_data == 'namespace_home':
    self.logger.info("Namespace home button clicked")
    await self._handle_namespace_home_button(update, context)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ü–æ–∑–∏—Ü–∏—è –∫–Ω–æ–ø–∫–∏**: 
   - –ö–Ω–æ–ø–∫–∞ "üè† –î–æ–º–æ–π" —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ **–ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ** –∫–Ω–æ–ø–æ–∫
   - –†–∞–∑–º–µ—â–µ–Ω–∞ –≤–º–µ—Å—Ç–µ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏ (–ù–∞–∑–∞–¥, –°—Ç—Ä–∞–Ω–∏—Ü–∞, –í–ø–µ—Ä–µ–¥)

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ callback**:
   - –°–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `_handle_namespace_home_button`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `_send_callback_message` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ `namespace_command`
   - –û—à–∏–±–∫–∞ `update.message is None` –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç

3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
   - –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω
   - –†–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ –∫–æ–º–∞–Ω–¥–µ `/list` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º –∏–º–µ–Ω

### üéØ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –ö–Ω–æ–ø–∫–∞ "üè† –î–æ–º–æ–π" –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∫–Ω–æ–ø–æ–∫
2. **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ –≥–ª–∞–≤–Ω–æ–º—É —Å–ø–∏—Å–∫—É –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω
3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –∫–æ–º–∞–Ω–¥–µ `/list` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ callback

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
1. –ü–æ–∑–∏—Ü–∏—é –∫–Ω–æ–ø–∫–∏ "–î–æ–º–æ–π" –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
2. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
4. –ü–æ–ª–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –≥–ª–∞–≤–Ω–æ–º—É —Å–ø–∏—Å–∫—É

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º –∏ –Ω–µ –Ω–∞—Ä—É—à–∞—é—Ç —Ä–∞–±–æ—Ç—É –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞.
