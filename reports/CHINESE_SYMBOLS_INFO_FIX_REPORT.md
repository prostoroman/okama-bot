# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã /info –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö –∏ –≥–æ–Ω–∫–æ–Ω–≥—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

## –ü—Ä–æ–±–ª–µ–º—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è**: –ö–∏—Ç–∞–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ —Ç–æ–ª—å–∫–æ –∫–∏—Ç–∞–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–µ–∑ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
2. **–û—à–∏–±–∫–∞ namespace**: –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ "SH is not in allowed assets namespaces"
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç—Ä–∏–∫**: –ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏**: –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

## –†–µ—à–µ–Ω–∏—è

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ Tushare

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `_format_tushare_info_response()`:**
```python
# Format header with Chinese and English names
if english_name and english_name != asset_name:
    header = f"üìä {asset_name} ({symbol})\n"
    header += f"üåê {english_name}\n"
else:
    header = f"üìä {asset_name} ({symbol})\n"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üìä Êµ¶ÂèëÈì∂Ë°å (600000.SH)
üåê SPD Bank
üìç Shanghai | Banking | SSE
```

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å namespace

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–∏—Ç–∞–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –Ω–∞–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –≤ okama, –Ω–æ SH –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ `_handle_info_period_button()`:
```python
# Determine data source
data_source = self.determine_data_source(symbol)

if data_source == 'tushare':
    # Handle Tushare assets
    await self._handle_tushare_info_period_button(update, context, symbol, period)
else:
    # Handle Okama assets
    await self._handle_okama_info_period_button(update, context, symbol, period)
```

### 3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `_handle_tushare_info_period_button()` - –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- `_handle_okama_info_period_button()` - –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- `_get_tushare_chart_for_period()` - –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –ø–µ—Ä–∏–æ–¥–æ–≤

### 4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `_get_mainland_stock_info()` –≤ TushareService:**
```python
# Calculate annual return and volatility
if len(daily_data) > 1:
    # Calculate returns
    daily_data = daily_data.sort_values('trade_date')
    daily_data['returns'] = daily_data['close'].pct_change().dropna()
    
    # Annual return (CAGR)
    if len(daily_data) > 30:  # Need at least 30 days
        total_return = (daily_data['close'].iloc[-1] / daily_data['close'].iloc[0]) - 1
        days = len(daily_data)
        annual_return = (1 + total_return) ** (365 / days) - 1
        info['annual_return'] = annual_return
        
        # Volatility (annualized)
        volatility = daily_data['returns'].std() * (365 ** 0.5)
        info['volatility'] = volatility
```

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `_format_tushare_info_response()`:**
```python
# Add calculated metrics if available
if 'annual_return' in symbol_info:
    annual_return = symbol_info['annual_return']
    return_sign = "+" if annual_return >= 0 else ""
    metrics_text += f"–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (–≥–æ–¥–æ–≤–∞—è): {return_sign}{annual_return:.1%}\n"

if 'volatility' in symbol_info:
    volatility = symbol_info['volatility']
    metrics_text += f"–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: {volatility:.1%}\n"
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ü—Ä–∏–º–µ—Ä –¥–ª—è Êµ¶ÂèëÈì∂Ë°å (600000.SH)

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
üìä Êµ¶ÂèëÈì∂Ë°å (600000.SH)
üìç Shanghai | Banking | SSE

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–∑–∞ 1 –≥–æ–¥):
–¶–µ–Ω–∞: 8.45 CNY (+0.12%)
–û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤: 45,678,901
–î–∞—Ç–∞ –ª–∏—Å—Ç–∏–Ω–≥–∞: 19991110
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
üìä Êµ¶ÂèëÈì∂Ë°å (600000.SH)
üåê SPD Bank
üìç Shanghai | Banking | SSE

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–∑–∞ 1 –≥–æ–¥):
–¶–µ–Ω–∞: 8.45 CNY (+0.12%)
–û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤: 45,678,901
–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (–≥–æ–¥–æ–≤–∞—è): +5.2%
–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: 18.7%
–î–∞—Ç–∞ –ª–∏—Å—Ç–∏–Ω–≥–∞: 19991110
```

### ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

- **1Y**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ 1 –≥–æ–¥
- **5Y**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ 5 –ª–µ—Ç
- **MAX**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥
- **–ë–µ–∑ –æ—à–∏–±–æ–∫ namespace**: –ö–∏—Ç–∞–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Tushare

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
‚úÖ Bot created successfully
‚úÖ Testing data source determination...
‚úÖ 600000.SH data source: tushare
‚úÖ AAPL.US data source: okama
‚úÖ Testing keyboard creation for Chinese symbol...
‚úÖ Keyboard created with 2 rows
‚úÖ MAX button text: MAX
‚úÖ Testing completed
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `_handle_tushare_info_period_button()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è Tushare
- `_handle_okama_info_period_button()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è Okama
- `_get_tushare_chart_for_period()` - –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –ø–µ—Ä–∏–æ–¥–æ–≤ Tushare

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `_format_tushare_info_response()` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
- `_get_mainland_stock_info()` - –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- `_handle_info_period_button()` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞:
- **–ö–∏—Ç–∞–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã** (.SH, .SZ) ‚Üí Tushare
- **–ì–æ–Ω–∫–æ–Ω–≥—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã** (.HK) ‚Üí Tushare  
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã** (.US, .LSE, etc.) ‚Üí Okama

## –î–µ–ø–ª–æ–π

- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ git
- ‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ GitHub
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∑–∞–ø—É—â–µ–Ω
- ‚úÖ GitHub Actions —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ Render

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –ö–æ–º–∞–Ω–¥–∞ `/info` —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∏—Ç–∞–π—Å–∫–∏–º–∏ –∏ –≥–æ–Ω–∫–æ–Ω–≥—Å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏

–¢–µ–ø–µ—Ä—å –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤:
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ Tushare
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Tushare –∏ Okama
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

–ö–æ–º–∞–Ω–¥–∞ `/info` —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∏—Ç–∞–π—Å–∫–∏–µ –∏ –≥–æ–Ω–∫–æ–Ω–≥—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã! üéâ
