# –û—Ç—á–µ—Ç –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ Risk/Return –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## –î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2025-01-27

## –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É Risk/Return –≤–æ –≤—Å–µ —Ç–∏–ø—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏–π `/compare`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç `ok.AssetList([selected_assets]) .plot_assets(kind="cagr")` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏ –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏, –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ–º—ã–º–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ –ø–æ–∫–∞–∑–∞ –∫–Ω–æ–ø–∫–∏

**–î–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# Add Risk / Return for portfolio-only comparisons
if has_portfolios_only:
    keyboard.append([
        InlineKeyboardButton("üìä Risk / Return", callback_data="risk_return_compare")
    ])
```

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# Add Risk / Return for all comparisons (portfolios + assets, assets only, portfolios only)
keyboard.append([
    InlineKeyboardButton("üìä Risk / Return", callback_data="risk_return_compare")
])
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∫–Ω–æ–ø–∫–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
1. **–£–±—Ä–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è**: –ö–Ω–æ–ø–∫–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
2. **–£–±—Ä–∞–Ω SP500TR.INDX**: –í AssetList —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤—ã –∏ –ø–æ—Ä—Ç—Ñ–µ–ª–∏
3. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏**: –í—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤—ã
4. **–£–ª—É—á—à–µ–Ω fallback**: –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç CAGR –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–∫—Ç–∏–≤–æ–≤ –≤ fallback —Ä–µ–∂–∏–º–µ

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
```python
# Create AssetList with selected assets/portfolios
asset_list = self._ok_asset_list(asset_list_items, currency=currency)

# okama plotting
asset_list.plot_assets(kind="cagr")
```

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏

### –ö–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞
- ‚úÖ –ü—Ä–∏ —Å–º–µ—à–∞–Ω–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏: `/compare PORTFOLIO_1 SPY.US`
- ‚úÖ –ü—Ä–∏ —Å–º–µ—à–∞–Ω–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏: `/compare PORTFOLIO_1 PORTFOLIO_2 SPY.US`
- ‚úÖ –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–æ–≤: `/compare SPY.US QQQ.US`
- ‚úÖ –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π: `/compare PORTFOLIO_1 PORTFOLIO_2`

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–Ω–æ–ø–∫–∞
1. **–°–æ–∑–¥–∞–µ—Ç AssetList** —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏ –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏
2. **–í—ã–ø–æ–ª–Ω—è–µ—Ç `plot_assets(kind="cagr")`** –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è CAGR
3. **–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—é** —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
4. **Fallback —Ä–µ–∂–∏–º** —Å–æ–∑–¥–∞–µ—Ç bar chart —Å —Ä—É—á–Ω—ã–º —Ä–∞—Å—á–µ—Ç–æ–º CAGR –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```
/compare PORTFOLIO_1 SPY.US
‚Üí –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "üìä Risk / Return"
‚Üí –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫: PORTFOLIO_1 vs SPY.US

/compare SPY.US QQQ.US
‚Üí –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "üìä Risk / Return"
‚Üí –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫: SPY.US vs QQQ.US
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```python
# Validate that we have symbols to compare
if not expanded_symbols:
    await self._send_callback_message(update, context, 
        "‚ÑπÔ∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /compare –∑–∞–Ω–æ–≤–æ.")
    return
```

### –°–æ–∑–¥–∞–Ω–∏–µ AssetList
```python
# Create AssetList with selected assets/portfolios
asset_list = self._ok_asset_list(asset_list_items, currency=currency)
```

### Fallback –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤
```python
# Calculate CAGR for each asset
for i, asset in enumerate(asset_list_items):
    asset_name = asset_names[i]
    try:
        if isinstance(asset, str):
            # Individual asset
            asset_obj = self._ok_asset(asset)
            cagr = asset_obj.get_cagr()
        else:
            # Portfolio
            cagr = asset.get_cagr()
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ CAGR
        cagr_values[asset_name] = cagr_val
    except Exception:
        # Manual CAGR calculation
        cagr_values[asset_name] = 0.0
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏
1. **–ö–Ω–æ–ø–∫–∞ Risk/Return** —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–∏ –≤—Å–µ—Ö —Ç–∏–ø–∞—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
2. **–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤—ã** –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (–±–µ–∑ SP500TR.INDX)
3. **–ü–æ—Ä—Ç—Ñ–µ–ª–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è** –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ì—Ä–∞—Ñ–∏–∫ CAGR** —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `ok.AssetList(...).plot_assets(kind="cagr")`
5. **Fallback —Ä–µ–∂–∏–º** —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–∫—Ç–∏–≤–æ–≤

### üéØ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ: –∫–Ω–æ–ø–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –æ–Ω–∞ –Ω—É–∂–Ω–∞
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –ö—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- –ù–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ fallback —Ä–µ–∂–∏–º–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
1. **–°–º–µ—à–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**: `/compare PF_1 SPY.US`
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ Risk/Return –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
   - ‚úÖ –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ PF_1 vs SPY.US

2. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤**: `/compare SPY.US QQQ.US`
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ Risk/Return –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
   - ‚úÖ –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ SPY.US vs QQQ.US

3. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π**: `/compare PF_1 PF_2`
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ Risk/Return –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
   - ‚úÖ –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ PF_1 vs PF_2

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ AssetList —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏ –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `plot_assets(kind="cagr")`
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ Fallback —Ä–µ–∂–∏–º –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–∫—Ç–∏–≤–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –ø–æ–¥–ø–∏—Å–∏
