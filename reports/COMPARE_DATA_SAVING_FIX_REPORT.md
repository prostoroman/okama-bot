# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üéØ –¶–µ–ª—å
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–∞–º –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫ Reply Keyboard.

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞:
- –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã `/compare` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∞–Ω–∞–ª–∏–∑—É"
- –ù–æ –∫–Ω–æ–ø–∫–∏ Reply Keyboard –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫—É "‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (`last_assets`) –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü—Ä–∏—á–∏–Ω–∞:
- –í –∫–æ–º–∞–Ω–¥–µ `compare_command()` —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ `current_symbols`, –Ω–æ –Ω–µ `last_assets`
- –ö–Ω–æ–ø–∫–∏ Reply Keyboard –∏—â—É—Ç –¥–∞–Ω–Ω—ã–µ –≤ `last_assets`, –∞ –Ω–µ –≤ `current_symbols`
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `last_currency` –∏ `last_period` –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥–∞

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫:
```
Roman: /compare SPY.US QQQ.US
Bot: üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∞–Ω–∞–ª–∏–∑—É

Roman: ‚ñ´Ô∏è –î–∏–≤–∏–¥–µ–Ω–¥—ã
Bot: ‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π /compare –∏–ª–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å –∫–æ–º–∞–Ω–¥–æ–π /portfolio
```

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

**–§–∞–π–ª:** `bot.py`
**–§—É–Ω–∫—Ü–∏—è:** `compare_command()`
**–°—Ç—Ä–æ–∫–∏:** 4326-4335

**–ë—ã–ª–æ:**
```python
user_context['current_symbols'] = clean_symbols
user_context['display_symbols'] = display_symbols  # Store descriptive names for display
user_context['current_currency'] = currency
user_context['current_period'] = specified_period  # Store period for buttons
user_context['last_analysis_type'] = 'comparison'
user_context['portfolio_contexts'] = portfolio_contexts  # Store portfolio contexts
user_context['expanded_symbols'] = expanded_symbols  # Store expanded symbols
```

**–°—Ç–∞–ª–æ:**
```python
user_context['current_symbols'] = clean_symbols
user_context['display_symbols'] = display_symbols  # Store descriptive names for display
user_context['current_currency'] = currency
user_context['current_period'] = specified_period  # Store period for buttons
user_context['last_analysis_type'] = 'comparison'
user_context['portfolio_contexts'] = portfolio_contexts  # Store portfolio contexts
user_context['expanded_symbols'] = expanded_symbols  # Store expanded symbols
user_context['last_assets'] = clean_symbols  # Store symbols for Reply Keyboard buttons
user_context['last_currency'] = currency  # Store currency for Reply Keyboard buttons
user_context['last_period'] = specified_period  # Store period for Reply Keyboard buttons
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

1. **`last_assets`**: –°–∏–º–≤–æ–ª—ã –¥–ª—è –∫–Ω–æ–ø–æ–∫ Reply Keyboard
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_handle_reply_keyboard_button()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
   - –°–æ–¥–µ—Ä–∂–∏—Ç –æ—á–∏—â–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (`clean_symbols`)

2. **`last_currency`**: –í–∞–ª—é—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_create_comparison_wealth_chart()` –∏ `_handle_compare_period_button()`
   - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–∞–ª—é—Ç—É –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–æ–≤

3. **`last_period`**: –ü–µ—Ä–∏–æ–¥ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_create_comparison_wealth_chart()` –∏ `_handle_compare_period_button()`
   - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–æ–≤

### –õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:

- **`clean_symbols`**: –û—á–∏—â–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –±–µ–∑ –æ–ø–∏—Å–∞–Ω–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
- **`display_symbols`**: –°–∏–º–≤–æ–ª—ã —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **`last_assets`**: –ö–æ–ø–∏—è `clean_symbols` –¥–ª—è –∫–Ω–æ–ø–æ–∫ Reply Keyboard

### –°–≤—è–∑—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º:

- **`_handle_reply_keyboard_button()`**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `last_assets` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **`_create_comparison_wealth_chart()`**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `last_currency` –∏ `last_period`
- **`_handle_compare_period_button()`**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `last_currency` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ö–æ–º–∞–Ω–¥–∞ `/compare SPY.US QQQ.US`**:
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è `last_assets = ['SPY.US', 'QQQ.US']`
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è `last_currency = 'USD'`
   - ‚úÖ –î–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è `last_period = None`

2. **–ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ Reply Keyboard**:
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "‚ñ´Ô∏è –î–∏–≤–∏–¥–µ–Ω–¥—ã" –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "‚ñ´Ô∏è –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å" –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ "‚ñ´Ô∏è –ú–µ—Ç—Ä–∏–∫–∏" –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

3. **–ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–∏–æ–¥–∞**:
   - ‚úÖ –ö–Ω–æ–ø–∫–∏ "1 –≥–æ–¥", "5 –ª–µ—Ç", "MAX" –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π
   - ‚úÖ –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–∞ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `last_currency`

4. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏**:
   - ‚úÖ –ü–æ—Å–ª–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - ‚úÖ –ü–æ—Å–ª–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
- ‚úÖ **`last_assets`**: –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–∏–º–≤–æ–ª—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- ‚úÖ **`last_currency`**: –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤–∞–ª—é—Ç—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- ‚úÖ **`last_period`**: –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–µ—Ä–∏–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö**: `last_assets` —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- ‚úÖ **–û—à–∏–±–∫–∏ –∫–Ω–æ–ø–æ–∫**: –ö–Ω–æ–ø–∫–∏ Reply Keyboard —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∫–Ω–æ–ø–æ–∫

### –£–ª—É—á—à–µ–Ω–∏—è:
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫**: –í—Å–µ –∫–Ω–æ–ø–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç
- **–ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–∏–æ–¥–∞**: –†–∞–±–æ—Ç–∞—é—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π –∏ –ø–µ—Ä–∏–æ–¥–æ–º
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ **–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è**: –û—Å—Ç–∞–ª–∏—Å—å –Ω–µ—Ç—Ä–æ–Ω—É—Ç—ã–º–∏
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ **–õ–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è**: –ù–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:
- ‚úÖ –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ª–∏–Ω—Ç–µ—Ä–æ–º
- ‚úÖ –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ò–∑–º–µ–Ω–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –õ–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∞
- –ö–Ω–æ–ø–∫–∏ Reply Keyboard —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–≤—è–∑—å –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏
