# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤ MOEX

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `/compare` —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏ (SBER.MOEX, LKOH.MOEX) –≤ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –º–µ—Ç—Ä–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è "N/A":

```
| –ú–µ—Ç—Ä–∏–∫–∞                         | SBER.MOEX   | LKOH.MOEX   |
|:--------------------------------|:------------|:------------|
| –°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (CAGR) | N/A         | N/A         |
| –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å                   | N/A         | N/A         |
| –ö–æ—ç—Ñ—Ñ. –®–∞—Ä–ø–∞                    | N/A         | N/A         |
| –ú–∞–∫—Å. –ø—Ä–æ—Å–∞–¥–∫–∞                  | N/A         | N/A         |
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —É Asset**: –û–±—ä–µ–∫—Ç `ok.Asset` –Ω–µ –∏–º–µ–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ `annual_return`, `volatility`, `sharpe`, `max_drawdown`
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ wealth_index**: –£ –æ–±—ä–µ–∫—Ç–∞ `Asset` –Ω–µ—Ç –∞—Ç—Ä–∏–±—É—Ç–∞ `wealth_index`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –ø–æ–ª—É—á–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –æ–±—ä–µ–∫—Ç–∞, –≤–º–µ—Å—Ç–æ —Ä–∞—Å—á–µ—Ç–∞ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞—Ç**: –û–±—ä–µ–∫—Ç—ã Period –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_summary_metrics_table`

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö:**
```python
# Try to get price data from different sources
if hasattr(asset_data, 'adj_close') and asset_data.adj_close is not None:
    prices = asset_data.adj_close
elif hasattr(asset_data, 'close_monthly') and asset_data.close_monthly is not None:
    prices = asset_data.close_monthly
elif hasattr(asset_data, 'close_daily') and asset_data.close_daily is not None:
    prices = asset_data.close_daily
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞—Ç:**
```python
# Handle different date types (Period, Timestamp, etc.)
if hasattr(start_date, 'to_timestamp'):
    start_date = start_date.to_timestamp()
if hasattr(end_date, 'to_timestamp'):
    end_date = end_date.to_timestamp()
```

### 2. –†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫

**CAGR (–°—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å):**
```python
years = (end_date - start_date).days / 365.25
total_return = (prices.iloc[-1] / prices.iloc[0]) - 1
cagr = (1 + total_return) ** (1 / years) - 1
```

**–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:**
```python
returns = prices.pct_change().dropna()
volatility = returns.std() * (252 ** 0.5)  # Annualized for daily data
```

**–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞:**
```python
risk_free_rate = 0.02  # 2% annual risk-free rate
sharpe = (cagr - risk_free_rate) / volatility
```

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞:**
```python
running_max = prices.expanding().max()
drawdown = (prices - running_max) / running_max
max_drawdown = drawdown.min()
```

### 3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤

- **Asset –æ–±—ä–µ–∫—Ç—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç `adj_close`, `close_monthly`, `close_daily`
- **Portfolio –æ–±—ä–µ–∫—Ç—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç `wealth_index`
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã**: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è "N/A"

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### SBER.MOEX
- **CAGR**: 14.59%
- **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å**: 43.47%
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞**: 0.29
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞**: -87.29%

### LKOH.MOEX
- **CAGR**: 17.58%
- **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å**: 35.90%
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞**: 0.43
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞**: -71.84%

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è "N/A" –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞—Ç (Period, Timestamp)
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Asset –∏ Portfolio –æ–±—ä–µ–∫—Ç–æ–≤
- ‚úÖ –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: `adj_close` > `close_monthly` > `close_daily` > `wealth_index`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞–Ω–Ω—É–∞–ª–∏–∑–∞—Ü–∏–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å fallback –Ω–∞ "N/A"

### –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
- CAGR: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –ê–Ω–Ω—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑—Ä–∏—Å–∫–æ–≤—É—é —Å—Ç–∞–≤–∫—É 2%
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞: –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç –ø–∏–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π –∏ –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –∞–∫—Ç–∏–≤–æ–≤
- –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ò–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã:
- –ö–æ–º–º–∏—Ç: `ac019eb`
- –°—Ç–∞—Ç—É—Å: –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ GitHub –∏ Render
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ü—Ä–æ–π–¥–µ–Ω–æ –¥–ª—è SBER.MOEX –∏ LKOH.MOEX
