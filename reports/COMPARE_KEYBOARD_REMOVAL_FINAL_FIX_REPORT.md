# –û—Ç—á–µ—Ç –æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –≤ –∫–æ–º–∞–Ω–¥–µ /compare

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–ª–∞ –≤ –∫–æ–º–∞–Ω–¥–∞—Ö `/info` –∏ `/portfolio`, –Ω–æ –Ω–µ –∏—Å—á–µ–∑–∞–ª–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare`. –ü–æ—Å–ª–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –∫–æ–º–∞–Ω–¥—ã `/compare` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`.

## üîç –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π

### ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /info - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–ú–µ—Ç–æ–¥**: –ü—Ä—è–º–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `await update.callback_query.edit_message_reply_markup(reply_markup=None)`
- **–ü—Ä–∏–º–µ—Ä**: `_handle_okama_info_period_button` (—Å—Ç—Ä–æ–∫–∏ 8688-8692)

### ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /portfolio - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
- **–ú–µ—Ç–æ–¥**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `_remove_keyboard_before_new_message`
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: `await self._remove_keyboard_before_new_message(update, context)`
- **–ü—Ä–∏–º–µ—Ä**: `_handle_portfolio_drawdowns_button` (—Å—Ç—Ä–æ–∫–∞ 12058)

### ‚ùå –ö–æ–º–∞–Ω–¥–∞ /compare - –±—ã–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞
- **–ú–µ—Ç–æ–¥**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `_remove_keyboard_before_new_message`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

## üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –§—É–Ω–∫—Ü–∏—è `_create_drawdowns_chart`
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 1472-1484
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 2. –§—É–Ω–∫—Ü–∏—è `_create_dividend_yield_chart`
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 1512-1524
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 3. –§—É–Ω–∫—Ü–∏—è `_create_correlation_matrix`
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 1575-1588
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 4. –§—É–Ω–∫—Ü–∏—è `_handle_drawdowns_button` (—Å–º–µ—à–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `bot.py`, —Å—Ç—Ä–æ–∫–∏ 8112-8124
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_drawdowns_chart`
```python
# Create keyboard for compare command
keyboard = self._create_compare_command_keyboard(symbols, currency)

# Remove keyboard from previous message before sending new message
await self._remove_keyboard_before_new_message(update, context)

# Send drawdowns chart with keyboard
await context.bot.send_photo(
    chat_id=update.effective_chat.id, 
    photo=io.BytesIO(img_bytes),
    caption=self._truncate_caption(f"üìâ –ì—Ä–∞—Ñ–∏–∫ Drawdowns –¥–ª—è {len(symbols)} –∞–∫—Ç–∏–≤–æ–≤\n\n–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–∏–æ–¥—ã –ø–∞–¥–µ–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤ –∏ –∏—Ö –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ"),
    reply_markup=keyboard
)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_dividend_yield_chart`
```python
# Create keyboard for compare command
keyboard = self._create_compare_command_keyboard(symbols, currency)

# Remove keyboard from previous message before sending new message
await self._remove_keyboard_before_new_message(update, context)

# Send dividend yield chart with keyboard
await context.bot.send_photo(
    chat_id=update.effective_chat.id, 
    photo=io.BytesIO(img_bytes),
    caption=self._truncate_caption(f"üí∞ –ì—Ä–∞—Ñ–∏–∫ –¥–∏–≤–∏–¥–µ–Ω–¥–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è {len(symbols)} –∞–∫—Ç–∏–≤–æ–≤\n\n–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–∏–≤–∏–¥–µ–Ω–¥–Ω—ã—Ö –≤—ã–ø–ª–∞—Ç –∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å"),
    reply_markup=keyboard
)
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_correlation_matrix`
```python
# Create keyboard for compare command
keyboard = self._create_compare_command_keyboard(symbols, currency)

# Remove keyboard from previous message before sending new message
await self._remove_keyboard_before_new_message(update, context)

# Send correlation matrix with keyboard
self.logger.info("Sending correlation matrix image...")
await context.bot.send_photo(
    chat_id=update.effective_chat.id, 
    photo=io.BytesIO(img_bytes),
    caption=self._truncate_caption(f"üîó –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è {len(symbols)} –∞–∫—Ç–∏–≤–æ–≤\n\n–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ –∞–∫—Ç–∏–≤–æ–≤ (–æ—Ç -1 –¥–æ +1)\n\n‚Ä¢ +1: –ø–æ–ª–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è\n‚Ä¢ 0: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏\n‚Ä¢ -1: –ø–æ–ª–Ω–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è"),
    reply_markup=keyboard
)
```

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_handle_drawdowns_button` (—Å–º–µ—à–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)
```python
# Create keyboard for compare command
keyboard = self._create_compare_command_keyboard(symbols, currency)

# Remove keyboard from previous message before sending new message
await self._remove_keyboard_before_new_message(update, context)

# Send drawdowns chart with keyboard
await context.bot.send_photo(
    chat_id=update.effective_chat.id, 
    photo=io.BytesIO(img_bytes),
    caption=self._truncate_caption(f"üìâ –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–æ–∫ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è\n\n–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Å–∞–¥–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–æ–≤"),
    reply_markup=keyboard
)
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã
–í –∫–æ–º–∞–Ω–¥–µ `/compare` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞:
1. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: –í—ã–∑–æ–≤ `_remove_keyboard_before_new_message` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ

### –†–µ—à–µ–Ω–∏–µ
–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ø–æ–¥—Ö–æ–¥ - —Ç–µ–ø–µ—Ä—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–º–∞–Ω–¥—ã `/compare` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:
1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
2. –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
3. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –∏—Å—á–µ–∑–∞–ª–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/compare`
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–ª–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/info`
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–ª–∞ –≤ –∫–æ–º–∞–Ω–¥–µ `/portfolio`

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç –≤ –∫–æ–º–∞–Ω–¥–µ `/compare`
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç –≤ –∫–æ–º–∞–Ω–¥–µ `/info`
- ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç –≤ –∫–æ–º–∞–Ω–¥–µ `/portfolio`

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –∫–æ–º–∞–Ω–¥—ã `/compare` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤—ã–∑–æ–≤ `_remove_keyboard_before_new_message`. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–∞—Ö:

- **–ö–æ–º–∞–Ω–¥–∞ /info**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–ö–æ–º–∞–Ω–¥–∞ /portfolio**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `_remove_keyboard_before_new_message`
- **–ö–æ–º–∞–Ω–¥–∞ /compare**: –¢–µ–ø–µ—Ä—å —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `_remove_keyboard_before_new_message`

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —á–∏—Å—Ç—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ "–∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö" –∫–ª–∞–≤–∏–∞—Ç—É—Ä –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö.
