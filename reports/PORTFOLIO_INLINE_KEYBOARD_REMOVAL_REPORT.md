# –û—Ç—á–µ—Ç –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ inline keyboard –∏–∑ –∫–æ–º–∞–Ω–¥—ã /portfolio

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ inline keyboard –Ω–∞ reply keyboard –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–æ–º–∞–Ω–¥—ã `/portfolio`. –£–¥–∞–ª–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∑–∞–ø—Ä–æ—Å..." –∏ "üéõÔ∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º".

## üéØ –¶–µ–ª–∏

1. ‚úÖ –£–¥–∞–ª–∏—Ç—å –≤—Å–µ inline keyboards –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—è
2. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –∏—Ö –Ω–∞ reply keyboard
3. ‚úÖ –£–±—Ä–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∑–∞–ø—Ä–æ—Å..." –∏ "üéõÔ∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º"
4. ‚úÖ –û–±–µ—Å–ø–µ—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–§–∞–π–ª:** `bot.py`
**–§—É–Ω–∫—Ü–∏—è:** `_create_portfolio_command_keyboard`

```python
# –ë–´–õ–û:
def _create_portfolio_command_keyboard(self, portfolio_symbol: str) -> InlineKeyboardMarkup:
    # –°–æ–∑–¥–∞–Ω–∏–µ inline keyboard —Å –∫–Ω–æ–ø–∫–∞–º–∏

# –°–¢–ê–õ–û:
def _create_portfolio_command_keyboard(self, portfolio_symbol: str) -> ReplyKeyboardMarkup:
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π reply keyboard —Ñ—É–Ω–∫—Ü–∏–∏
    return self._create_portfolio_reply_keyboard()
```

### 2. –£–¥–∞–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–§—É–Ω–∫—Ü–∏—è:** `_handle_portfolio_reply_keyboard_button`
- –£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ "üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∑–∞–ø—Ä–æ—Å..."

**–§—É–Ω–∫—Ü–∏—è:** `_show_portfolio_reply_keyboard`
- –ò–∑–º–µ–Ω–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å "üéõÔ∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º" –Ω–∞ "üìä –ü–æ—Ä—Ç—Ñ–µ–ª—å –≥–æ—Ç–æ–≤ –∫ –∞–Ω–∞–ª–∏–∑—É"

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:** `_send_portfolio_message_with_reply_keyboard`

```python
async def _send_portfolio_message_with_reply_keyboard(self, update: Update, context: ContextTypes.DEFAULT_TYPE, text: str, parse_mode: str = None):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è —Å reply keyboard"""
    try:
        chat_id = update.effective_chat.id
        reply_keyboard = self._create_portfolio_reply_keyboard()
        
        await context.bot.send_message(
            chat_id=chat_id,
            text=text,
            parse_mode=parse_mode,
            reply_markup=reply_keyboard
        )
    except Exception as e:
        self.logger.error(f"Error in _send_portfolio_message_with_reply_keyboard: {e}")
        await self._send_message_safe(update, text, parse_mode=parse_mode)
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—è

–ó–∞–º–µ–Ω–µ–Ω—ã –≤—ã–∑–æ–≤—ã `_send_callback_message_with_keyboard_removal` —Å inline keyboard –Ω–∞ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é `_send_portfolio_message_with_reply_keyboard` –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö:

- `_handle_portfolio_risk_metrics_by_symbol`
- `_handle_portfolio_monte_carlo_by_symbol`
- `_handle_portfolio_forecast_by_symbol`
- `_handle_portfolio_drawdowns_by_symbol`
- `_handle_portfolio_dividends_by_symbol`
- `_handle_portfolio_returns_by_symbol`
- `_handle_portfolio_wealth_chart_by_symbol`
- `_handle_portfolio_rolling_cagr_by_symbol`
- `_handle_portfolio_compare_assets_by_symbol`
- `_handle_portfolio_ai_analysis_button`
- `_handle_portfolio_main_button`

### 5. –£–ø—Ä–æ—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç reply keyboard –Ω–∞–ø—Ä—è–º—É—é:

```python
# –ë–´–õ–û:
keyboard = self._create_portfolio_command_keyboard(portfolio_symbol)
await self._remove_keyboard_before_new_message(update, context)
await context.bot.send_photo(..., reply_markup=keyboard)

# –°–¢–ê–õ–û:
reply_keyboard = self._create_portfolio_reply_keyboard()
await context.bot.send_photo(..., reply_markup=reply_keyboard)
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ reply keyboard

Reply keyboard —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏:

**–ü–µ—Ä–≤—ã–π —Ä—è–¥:**
- ‚ñ´Ô∏è –ù–∞–∫–æ–ø. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- ‚ñ´Ô∏è –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- ‚ñ´Ô∏è –°–∫–æ–ª—å–∑—è—â–∞—è CAGR
- ‚ñ´Ô∏è –î–∏–≤–∏–¥–µ–Ω–¥—ã

**–í—Ç–æ—Ä–æ–π —Ä—è–¥:**
- ‚ñ´Ô∏è –ú–µ—Ç—Ä–∏–∫–∏
- ‚ñ´Ô∏è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ
- ‚ñ´Ô∏è –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ (10/50/90)
- ‚ñ´Ô∏è –ü—Ä–æ—Å–∞–¥–∫–∏

**–¢—Ä–µ—Ç–∏–π —Ä—è–¥:**
- ‚ñ´Ô∏è AI-–∞–Ω–∞–ª–∏–∑
- ‚ñ´Ô∏è –ü–æ—Ä—Ç—Ñ–µ–ª—å vs –ê–∫—Ç–∏–≤—ã
- ‚ñ´Ô∏è –°—Ä–∞–≤–Ω–∏—Ç—å

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

1. **–£–ø—Ä–æ—â–µ–Ω–∏–µ UX:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ reply keyboard –±–µ–∑ inline –∫–Ω–æ–ø–æ–∫
2. **–£–¥–∞–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:** –£–±—Ä–∞–Ω—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∑–∞–ø—Ä–æ—Å..." –∏ "–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º"
3. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∏—â–µ

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∫–æ–º–∞–Ω–¥–æ–π `/portfolio`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ reply keyboard
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è inline –∫–Ω–æ–ø–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—è

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –§—É–Ω–∫—Ü–∏—è `_create_portfolio_reply_keyboard` —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞ –∏ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞
- –£–¥–∞–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ inline keyboards, reply keyboard –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ inline keyboard –Ω–∞ reply keyboard –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `/portfolio`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∞–ª –±–æ–ª–µ–µ —á–∏—Å—Ç—ã–º –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ inline –∫–Ω–æ–ø–æ–∫.
