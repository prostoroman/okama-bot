# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω –≤ Reply Keyboard

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω –≤ –∫–æ–º–∞–Ω–¥–µ `/list` –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–Ω–æ–ø–∫–∏: 'NoneType' object has no attribute 'message'
```

## –ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏

–§—É–Ω–∫—Ü–∏—è `_handle_namespace_reply_keyboard_button()` –≤—ã–∑—ã–≤–∞–ª–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `_show_namespace_symbols_with_reply_keyboard()`
- `_show_tushare_namespace_symbols_with_reply_keyboard()`

–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ–∂–∏–¥–∞–ª–∏ `update.callback_query.message`, –Ω–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫ reply keyboard —É –Ω–∞—Å –µ—Å—Ç—å `update.message`, –∞ `update.callback_query` —Ä–∞–≤–µ–Ω `None`.

## –†–µ—à–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π

**–§–∞–π–ª:** `bot.py`  
**–§—É–Ω–∫—Ü–∏—è:** `_handle_namespace_reply_keyboard_button()`

**–ë—ã–ª–æ:**
```python
# Check if it's a Chinese exchange
chinese_exchanges = ['SSE', 'SZSE', 'BSE', 'HKEX']
if namespace in chinese_exchanges:
    await self._show_tushare_namespace_symbols_with_reply_keyboard(update, context, namespace, page=0)
else:
    await self._show_namespace_symbols_with_reply_keyboard(update, context, namespace, page=0)
```

**–°—Ç–∞–ª–æ:**
```python
# Check if it's a Chinese exchange
chinese_exchanges = ['SSE', 'SZSE', 'BSE', 'HKEX']
if namespace in chinese_exchanges:
    await self._show_tushare_namespace_symbols(update, context, namespace, is_callback=False, page=0)
else:
    await self._show_namespace_symbols(update, context, namespace, is_callback=False, page=0)
```

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
- `_show_namespace_symbols()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –æ–±—ã—á–Ω—ã—Ö –±–∏—Ä–∂
- `_show_tushare_namespace_symbols()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ –∫–∏—Ç–∞–π—Å–∫–∏—Ö –±–∏—Ä–∂

**–ü–∞—Ä–∞–º–µ—Ç—Ä `is_callback=False`:**
- –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–µ callback —Å–æ–æ–±—â–µ–Ω–∏–µ
- –§—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `update.message` –≤–º–µ—Å—Ç–æ `update.callback_query.message`
- –°–æ–∑–¥–∞–µ—Ç—Å—è reply keyboard –≤–º–µ—Å—Ç–æ inline keyboard

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### 2. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π (callback vs message)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (inline vs reply)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### 3. –ü—Ä–æ—Å—Ç–æ—Ç–∞
- ‚úÖ –ú–µ–Ω—å—à–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ï–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**Callback —Å–æ–æ–±—â–µ–Ω–∏—è (inline keyboard):**
- `update.callback_query` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ
- `update.message` —Ä–∞–≤–µ–Ω `None`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `is_callback=True`
- –°–æ–∑–¥–∞–µ—Ç—Å—è inline keyboard

**–û–±—ã—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (reply keyboard):**
- `update.message` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ
- `update.callback_query` —Ä–∞–≤–µ–Ω `None`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `is_callback=False`
- –°–æ–∑–¥–∞–µ—Ç—Å—è reply keyboard

### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**`_show_namespace_symbols(update, context, namespace, is_callback=False, page=0)`:**
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É `is_callback`
- –°–æ–∑–¥–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É (inline –∏–ª–∏ reply)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

**`_show_tushare_namespace_symbols(update, context, namespace, is_callback=False, page=0)`:**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö –±–∏—Ä–∂
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
```bash
python3 -c "import bot; print('Bot imports successfully')"
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–ø–µ—à–Ω–æ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ö–æ–º–∞–Ω–¥–∞ /list –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

1. **–ü–æ–∫–∞–∑ reply keyboard** —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω
2. **–ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, üá∫üá∏ US)
3. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–¥–∞** –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω (US)
4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –±–∏—Ä–∂–∏** (–æ–±—ã—á–Ω–∞—è –∏–ª–∏ –∫–∏—Ç–∞–π—Å–∫–∞—è)
5. **–í—ã–∑–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏** —Å `is_callback=False`
6. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤** —Å reply keyboard –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω

**–û–±—ã—á–Ω—ã–µ –±–∏—Ä–∂–∏ (okama):** US, MOEX, LSE, XETR, XFRA, XAMS, INDX, FX, CBR, COMM, CC, RE, INFL, PIF, RATE

**–ö–∏—Ç–∞–π—Å–∫–∏–µ –±–∏—Ä–∂–∏ (tushare):** SSE, SZSE, BSE, HKEX

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û—à–∏–±–∫–∞ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞:

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `is_callback=False`
2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** - –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
4. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –º–µ–Ω—å—à–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –µ–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±—Ä–∞–±–æ—Ç–∫–∏

–¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω –≤ –∫–æ–º–∞–Ω–¥–µ `/list` —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç —Å–∏–º–≤–æ–ª—ã —Å reply keyboard –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å.
