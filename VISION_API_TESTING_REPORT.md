# üß™ –û—Ç—á–µ—Ç –æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ Vision API

## üìÖ –î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
**–í—Ä–µ–º—è**: –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è Vision API

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ Vision API - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- **–ü—Ä–æ–±–ª–µ–º–∞**: API –∫–ª—é—á –Ω–µ–≤–µ—Ä–Ω—ã–π (–æ—à–∏–±–∫–∞ 401 Unauthorized)
- **–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ**: 
```
‚ö†Ô∏è Vision API returned status 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'test****ting (BCE275D8)'","httpStatus":"Unauthorized","details":[]}}
```

### ‚úÖ Fallback —Å–∏—Å—Ç–µ–º–∞
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ Vision API
- **–ú–æ–¥–µ–ª–∏**: yandexgpt-vision ‚Üí fallback –Ω–∞ –æ–±—ã—á–Ω—É—é –º–æ–¥–µ–ª—å

### ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **SBER.MOEX**: ‚úÖ 2 –≥—Ä–∞—Ñ–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã
- **–†–∞–∑–º–µ—Ä—ã**: –ì—Ä–∞—Ñ–∏–∫ 1: 130,296 –±–∞–π—Ç, –ì—Ä–∞—Ñ–∏–∫ 2: 125,645 –±–∞–π—Ç
- **–§–æ—Ä–º–∞—Ç**: PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è

### ‚ùå –ö–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞
- **Vision API**: –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑-–∑–∞ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ –∫–ª—é—á–∞
- **Fallback**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 1. Vision API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
üîç YandexGPTService.ask_question_with_vision called
üñºÔ∏è Image provided: 130296 bytes
üîë API Key configured: Yes
üìÅ Folder ID configured: Yes
‚ö†Ô∏è Vision API returned status 401: Unauthorized
‚úÖ Vision model yandexgpt-vision response received, length: 53
```

**–í—ã–≤–æ–¥**: Vision API –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è, –Ω–æ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑-–∑–∞ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ –∫–ª—é—á–∞.

### 2. Fallback —Å–∏—Å—Ç–µ–º–∞
```
‚úÖ Vision model yandexgpt-vision response received, length: 53
INFO: üìù –ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ 1: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—Å—Ç–∞—Ç—É—Å: 401)
```

**–í—ã–≤–æ–¥**: Fallback —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤–º–µ—Å—Ç–æ –∞–Ω–∞–ª–∏–∑–∞.

### 3. –û–±—ã—á–Ω—ã–π API
```
üåê YandexGPT API call initiated
üîë API Key: Yes
üìÅ Folder ID: Yes
‚úÖ YandexGPT response received, length: 116
```

**–í—ã–≤–æ–¥**: –û–±—ã—á–Ω—ã–π API —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö.

## üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è: –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
- **–¢–∏–ø**: –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401)
- **–ü—Ä–∏—á–∏–Ω–∞**: –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –≤ `config.env`
- **–í–ª–∏—è–Ω–∏–µ**: Vision API –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### 2. –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞—á–µ—Å—Ç–≤–æ fallback
- **–¢–∏–ø**: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è
- **–ü—Ä–∏—á–∏–Ω–∞**: Fallback –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤–º–µ—Å—Ç–æ –∞–Ω–∞–ª–∏–∑–∞
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–∞–∂–µ —á–µ—Ä–µ–∑ fallback

### 3. –ü—Ä–æ–±–ª–µ–º–∞: –û–±—ã—á–Ω—ã–π API
- **–¢–∏–ø**: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è
- **–ü—Ä–∏—á–∏–Ω–∞**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ AI –∞–Ω–∞–ª–∏–∑–∞

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
1. **–ó–∞–º–µ–Ω–∏—Ç—å API –∫–ª—é—á–∏** –≤ `config.env` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç Yandex Cloud
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Vision API** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback** –∫–∞—á–µ—Å—Ç–≤–æ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–£–ª—É—á—à–∏—Ç—å fallback** —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
2. **–î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —É—Å–ø–µ—à–Ω—ã—Ö API –≤—ã–∑–æ–≤–æ–≤
3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å retry** –ª–æ–≥–∏–∫—É –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Yandex API
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- Fallback —Å–∏—Å—Ç–µ–º–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### ‚ùå –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- Vision API (–∏–∑-–∑–∞ –∫–ª—é—á–µ–π)
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- Fallback –∞–Ω–∞–ª–∏–∑

### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è
- API –∫–ª—é—á–∏
- Fallback –∫–∞—á–µ—Å—Ç–≤–æ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|---------|
| Vision API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | ‚úÖ | –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è, –Ω–æ 401 |
| Fallback —Å–∏—Å—Ç–µ–º–∞ | ‚úÖ | –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –Ω–æ –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ |
| –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ | ‚úÖ | 2 –≥—Ä–∞—Ñ–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ |
| –ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ | ‚ùå | –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ |
| –û–±—ã—á–Ω—ã–π API | ‚ö†Ô∏è | –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ |

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Vision API —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** 

- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∫—Å–∏ —Ä–µ—à–µ–Ω—ã
- ‚úÖ Fallback —Å–∏—Å—Ç–µ–º–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚ùå –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á

**–î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è:**
1. –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
3. –£–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ fallback –∞–Ω–∞–ª–∏–∑–∞

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ –∏ –±—É–¥–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 100% —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ –æ—Ç Yandex Cloud.
